#!/usr/bin/env node
(function(pe){"use strict";var w=function(){return I.__string_rec(this,"")},q=q||{},u;class T{constructor(e,t){this.r=new RegExp(e,t.split("u").join(""))}match(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,this.r.m!=null}matched(e){if(this.r.m!=null&&e>=0&&e<this.r.m.length)return this.r.m[e];throw b.thrown("EReg::matched")}}T.__name__=!0;class S{static cca(e,t){let n=e.charCodeAt(t);if(n==n)return n}static substr(e,t,n){if(n==null)n=e.length;else if(n<0)if(t==0)n=e.length+n;else return"";return e.substr(t,n)}static now(){return Date.now()}}S.__name__=!0;class ${static fold(e,t,n){let s=he(e);for(;s.hasNext();)n=t(s.next(),n);return n}static find(e,t){let n=he(e);for(;n.hasNext();){let s=n.next();if(t(s))return s}return null}}$.__name__=!0,Math.__name__=!0;class y{static string(e){return I.__string_rec(e,"")}}y.__name__=!0;class v{static isSpace(e,t){let n=S.cca(e,t);return n>8&&n<14?!0:n==32}static ltrim(e){let t=e.length,n=0;for(;n<t&&v.isSpace(e,n);)++n;return n>0?S.substr(e,n,t-n):e}static rtrim(e){let t=e.length,n=0;for(;n<t&&v.isSpace(e,t-n-1);)++n;return n>0?S.substr(e,0,t-n):e}static trim(e){return v.ltrim(v.rtrim(e))}static lpad(e,t,n){if(t.length<=0)return e;let s="";for(n-=e.length;s.length<n;)s+=t==null?"null":""+t;return s+=e==null?"null":""+e,s}}v.__name__=!0;var C=q["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:w},Module:(u=function(i){return{_hx_index:1,m:i,__enum__:"haxe.StackItem",toString:w}},u._hx_name="Module",u.__params__=["m"],u),FilePos:(u=function(i,e,t,n){return{_hx_index:2,s:i,file:e,line:t,column:n,__enum__:"haxe.StackItem",toString:w}},u._hx_name="FilePos",u.__params__=["s","file","line","column"],u),Method:(u=function(i,e){return{_hx_index:3,classname:i,method:e,__enum__:"haxe.StackItem",toString:w}},u._hx_name="Method",u.__params__=["classname","method"],u),LocalFunction:(u=function(i){return{_hx_index:4,v:i,__enum__:"haxe.StackItem",toString:w}},u._hx_name="LocalFunction",u.__params__=["v"],u)};C.__constructs__=[C.CFunction,C.Module,C.FilePos,C.Method,C.LocalFunction];class b extends Error{constructor(e,t,n){super(e),this.message=e,this.__previousException=t,this.__nativeException=n??this}unwrap(){return this.__nativeException}get_native(){return this.__nativeException}static caught(e){return e instanceof b?e:e instanceof Error?new b(e.message,null,e):new B(e,null,e)}static thrown(e){return e instanceof b?e.get_native():e instanceof Error?e:new B(e)}}b.__name__=!0;class B extends b{constructor(e,t,n){super(String(e),t,n),this.value=e}unwrap(){return this.value}}B.__name__=!0;class X{constructor(e){this.current=0,this.array=e}hasNext(){return this.current<this.array.length}next(){return this.array[this.current++]}}X.__name__=!0;class I{static __string_rec(e,t){if(e==null)return"null";if(t.length>=5)return"<...>";let n=typeof e;switch(n=="function"&&(e.__name__||e.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(e.__enum__){let _=q[e.__enum__].__constructs__[e._hx_index],x=_._hx_name;return _.__params__?(t=t+"	",x+"("+function(k){var f;let p=[];{let d=0,m=_.__params__;for(;d<m.length;){let E=m[d];d=d+1,p.push(I.__string_rec(e[E],t))}}return f=p,f}(this).join(",")+")"):x}if(e instanceof Array){let c="[";t+="	";let _=0,x=e.length;for(;_<x;){let k=_++;c+=(k>0?",":"")+I.__string_rec(e[k],t)}return c+="]",c}let s;try{s=e.toString}catch{return"???"}if(s!=null&&s!=Object.toString&&typeof s=="function"){let c=e.toString();if(c!="[object Object]")return c}let r=`{
`;t+="	";let a=e.hasOwnProperty!=null,l=null;for(l in e)a&&!e.hasOwnProperty(l)||l=="prototype"||l=="__class__"||l=="__super__"||l=="__interfaces__"||l=="__properties__"||(r.length!=2&&(r+=`, 
`),r+=t+l+" : "+I.__string_rec(e[l],t));return t=t.substring(1),r+=`
`+t+"}",r;case"string":return e;default:return String(e)}}}I.__name__=!0;var me=require("buffer").Buffer;class M{constructor(){this.version=!1,this.help=!1}run(e){if(this.help||this.version){let n=this.version?O.get_packageVersion():new Q().format(D.get());return process.stdout.write(y.string(n)),process.stdout.write(`
`),new j(new R(o.Success(null)))}let t=process.env.HAXELIB_RUN=="1"?2:1;return e.length<t?new j(new R(o.Failure(new F(400,"You must provide the path to the input directory.",{fileName:"src/php_minify/Program.hx",lineNumber:34,className:"php_minify.Program",methodName:"run"})))):new j(new R(o.Success(null)))}static main(){new K(new M,new te(5)).process(process.argv.slice(2)).handle(Y.exit)}}M.__name__=!0;class O{static get_packageVersion(){return O.packageVersion==null&&(O.packageVersion="1.0.0"),O.packageVersion}}O.__name__=!0;class Y{static exit(e){switch(e._hx_index){case 0:process.exit(0);break;case 1:let t=e.failure,n=t.message;t.data!=null&&(n+=", "+(t.data==null?"null":y.string(t.data))),process.stdout.write(y.string(n)),process.stdout.write(`
`);let s=t.code;process.exit(s);break}}}Y.__name__=!0;class J{constructor(e){this.buffer=e}}J.__name__=!0;class D{static get(){return D.doc==null&&(D.doc={doc:" Minify PHP source code by removing comments and whitespace. ",commands:[{isDefault:!0,isSub:!1,names:[],doc:`\r
		<input> : The input directory.\r
		[output] : The output directory.\r
	`}],flags:[{names:["--help"],aliases:["h"],doc:" Display this help. "},{names:["--version"],aliases:["v"],doc:" Output the version number. "}]}),D.doc}}D.__name__=!0;class z{constructor(e,t,n){this.command=e,this.prompt=t,this.hasFlags=n}processArgs(e){let t=this;return this.hasFlags?F.catchExceptions(function(){let n=z.expandAssignments(e),s=[],r=0,a=!1;for(;r<n.length;){let l=n[r];if(l=="--")a=!0,++r;else if(!a&&S.cca(l,0)==45){let c=t.processFlag(n,r);if(c==-1)if(S.cca(l,1)!=45){let _=t.processAlias(n,r);if(_==-1)throw b.thrown('Unrecognized alias "'+l+'"');r+=_+1}else throw b.thrown('Unrecognized flag "'+l+'"');else r+=c+1}else s.push(l),++r}return s},null,{fileName:"tink/cli/Router.hx",lineNumber:25,className:"tink.cli.Router",methodName:"processArgs"}):o.Success(e)}processFlag(e,t){return-1}processAlias(e,t){return-1}static expandAssignments(e){let t=[],n=!0,s=0;for(;s<e.length;){let r=e[s];if(++s,r=="--"&&(n=!1),!n)t.push(r);else{let a=S.cca(r,0),l=S.cca(r,1),c=r.indexOf("=");a==null?t.push(r):a==45?l==null?t.push(r):l==45&&c!=-1?(t.push(S.substr(r,0,c)),t.push(S.substr(r,c+1,null))):t.push(r):t.push(r)}}return t}}z.__name__=!0;class K extends z{constructor(e,t){super(e,t,!0)}process(e){let t=this;if(e[0]==null){let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new j(new R(o.Failure(s.failure)))}return ie.next(this.promptRequired(),function(r){return t.run_run(n)})}else{let n,s=this.processArgs(e);switch(s._hx_index){case 0:n=s.data;break;case 1:return new j(new R(o.Failure(s.failure)))}return ie.next(this.promptRequired(),function(r){return t.run_run(n)})}}processFlag(e,t){switch(e[t]){case"--help":this.command.help=!0;break;case"--version":this.command.version=!0;break;default:return-1}return t-t}processAlias(e,t){let n=e[t],s=1,r=n.length;for(;s<r;){let a=s++,l=S.cca(n,a);if(l==null)throw b.thrown("Invalid alias '-"+n.charAt(a)+"'");switch(l){case 104:this.command.help=!0;break;case 118:this.command.version=!0;break;default:throw b.thrown("Invalid alias '-"+n.charAt(a)+"'")}}return t-t}promptRequired(){return N.async(function(e){e(o.Success(null))})}run_run(e){return e.length<0?new j(new R(o.Failure(new F(null,"Insufficient arguments. Expected: 0, Got: "+e.length,{fileName:"src/php_minify/Program.hx",lineNumber:27,className:"tink.cli.Router0",methodName:"run_run"})))):this.command.run(e.slice(0,e.length))}}K.__name__=!0;class Q{constructor(e){this.re=new T("^\\s*\\*?\\s{0,2}(.*)$",""),this.root=e}format(e){let t="";t+=`
`;let n=this.formatDoc(e.doc);n!=null&&(t+=y.string(""+n+`

`));let s=e.commands,r=[],a=0;for(;a<s.length;){let _=s[a];++a,_.isDefault||r.push(_)}this.root!=null&&(t+=y.string("  Usage: "+this.root+`
`));let l=$.find(e.commands,function(_){return _.isDefault});if(l!=null){let _=this.formatDoc(l.doc);_!=null&&(t+=y.string(this.indent(_,4)+`

`))}let c=this;if(r.length>0){let _=$.fold(r,function(f,p){let d=0,m=f.names;for(;d<m.length;){let E=m[d];++d,E.length>p&&(p=E.length)}return p},0);this.root!=null&&(t+=y.string("  Usage: "+this.root+` <subcommand>
`)),t+=y.string(`    Subcommands:
`);let x=function(f,p){p==null&&(p="(doc missing)"),t+=y.string(c.indent(v.lpad(f," ",_)+" : "+v.trim(c.indent(p,_+3)),6)+`
`)},k=0;for(;k<r.length;){let f=r[k];++k;let p=f.names[0];if(x(p,this.formatDoc(f.doc)),f.names.length>1){let d=1,m=f.names.length;for(;d<m;)x(f.names[d++],"Alias of "+p)}}}if(e.flags.length>0){let _=function(d){let m=d.names.join(", ");if(d.aliases.length>0){let E=d.aliases,oe=new Array(E.length),de=0,ge=E.length;for(;de<ge;){let fe=de++;oe[fe]="-"+E[fe]}m+=", "+oe.join(", ")}return m},x=$.fold(e.flags,function(d,m){let E=_(d);return E.length>m&&(m=E.length),m},0),k=function(d,m){m==null&&(m=""),t+=y.string(c.indent(v.lpad(d," ",x)+" : "+v.trim(c.indent(m,x+3)),6)+`
`)};t=(t+=`
`)+y.string(`  Flags:
`);let f=0,p=e.flags;for(;f<p.length;){let d=p[f];++f,k(_(d),this.formatDoc(d.doc))}}return t}indent(e,t){let n=e.split(`
`),s=new Array(n.length),r=0,a=n.length;for(;r<a;){let l=r++;s[l]=v.lpad(""," ",t)+n[l]}return s.join(`
`)}formatDoc(e){if(e==null)return null;let t=e.split(`
`),n=v.trim,s=new Array(t.length),r=0,a=t.length;for(;r<a;){let k=r++;s[k]=n(t[k])}let l=s;for(;l[0]=="";)l=l.slice(1);for(;l[l.length-1]=="";)l.pop();let c=new Array(l.length),_=0,x=l.length;for(;_<x;){let k=_++,f=l[k];c[k]=this.re.match(f)?this.re.matched(1):f}return c.join(`
`)}}Q.__name__=!0;class Z{constructor(e,t){this.source=e,this.sink=t}}Z.__name__=!0;class ee extends Z{constructor(){let e=process.stdin,t=null;t={},super(W.wrap("stdin",e,t.chunkSize,t.onEnd),V.wrap("stdout",process.stdout))}}ee.__name__=!0;class te{constructor(e,t){this.trials=e,this.proxy=t??new ee}}te.__name__=!0;class h{static invoke(e,t){h.depth<500?(h.depth++,e(t),h.depth--):h.defer(function(){e(t)})}static defer(e){global.setImmediate(e)}}class ne{constructor(){}cancel(){let e=this.link;e?.cancel()}}ne.__name__=!0;class G{constructor(e,t){this.dissolved=!1,this.a=e,this.b=t}cancel(){if(!this.dissolved){this.dissolved=!0;let e=this.a;e?.cancel();let t=this.b;t?.cancel(),this.a=null,this.b=null}}}G.__name__=!0;class se{constructor(e,t){if(e==null)throw b.thrown("callback expected but null received");this.cb=e,this.list=t}cancel(){if(this.list!=null){let e=this.list;this.cb=null,this.list=null,--e.used<=e.cells.length>>1&&e.compact()}}}se.__name__=!0;class L{constructor(e){L._hx_skip_constructor||this._hx_constructor(e)}_hx_constructor(e){this.disposeHandlers=[],this.f=e}dispose(){let e=this.disposeHandlers;if(e!=null){this.disposeHandlers=null;let t=this.f;this.f=L.noop,t();let n=0;for(;n<e.length;)e[n++]()}}static noop(){}}L.__name__=!0;class re extends L{constructor(e){L._hx_skip_constructor=!0,super(),L._hx_skip_constructor=!1,this._hx_constructor(e)}_hx_constructor(e){e==null&&(e=!1),this.onfill=function(){},this.ondrain=function(){},this.busy=!1,this.queue=[],this.used=0;let t=this;super._hx_constructor(function(){t.busy||t.destroy()}),this.destructive=e,this.cells=[]}destroy(){let e=0,t=this.cells;for(;e<t.length;){let n=t[e];++e,n.cb=null,n.list=null}if(this.queue=null,this.cells=null,this.used>0){this.used=0;let n=this.ondrain;h.depth<500?(h.depth++,n(),h.depth--):h.defer(n)}}invoke(e){let t=this;if(h.depth<500){if(h.depth++,t.disposeHandlers!=null)if(t.busy){if(t.destructive!=!0){let n=t,s=e,r=function(){n.invoke(s)};t.queue.push(r)}}else{t.busy=!0,t.destructive&&t.dispose();let n=t.cells.length,s=0;for(;s<n;){let r=t.cells[s++];r.list!=null&&r.cb(e)}t.busy=!1,t.disposeHandlers==null?t.destroy():(t.used<t.cells.length&&t.compact(),t.queue.length>0&&t.queue.shift()())}h.depth--}else h.defer(function(){if(t.disposeHandlers!=null)if(t.busy){if(t.destructive!=!0){let n=t,s=e,r=function(){n.invoke(s)};t.queue.push(r)}}else{t.busy=!0,t.destructive&&t.dispose();let n=t.cells.length,s=0;for(;s<n;){let r=t.cells[s++];r.list!=null&&r.cb(e)}t.busy=!1,t.disposeHandlers==null?t.destroy():(t.used<t.cells.length&&t.compact(),t.queue.length>0&&t.queue.shift()())}})}compact(){if(!this.busy)if(this.used==0){this.resize(0);let e=this.ondrain;h.depth<500?(h.depth++,e(),h.depth--):h.defer(e)}else{let e=0,t=0,n=this.cells.length;for(;t<n;){let s=t++,r=this.cells[s];if(r.cb!=null&&(e!=s&&(this.cells[e]=r),++e==this.used))break}this.resize(this.used)}}resize(e){this.cells.length=e}}re.__name__=!0;class F{constructor(e,t,n){e==null&&(e=500),this.isTinkError=!0,this.code=e,this.message=t,this.pos=n,this.exceptionStack=[],this.callStack=[]}static withData(e,t,n,s){return F.typed(e,t,n,s)}static typed(e,t,n,s){let r=new F(e,t,s);return r.data=n,r}static asError(e){return e!=null&&e.isTinkError?e:null}static catchExceptions(e,t,n){try{return o.Success(e())}catch(s){let r=b.caught(s).unwrap(),a=F.asError(r);return o.Failure(a??(t==null?F.withData(null,"Unexpected Error",r,n):t(r)))}}}F.__name__=!0;class A{constructor(){A._hx_skip_constructor||this._hx_constructor()}_hx_constructor(){}getStatus(){return g.NeverEver}handle(e){return null}eager(){}}A.__name__=!0;class R{constructor(e){this.value=e}isComputed(){return!0}get(){return this.value}compute(){}}R.__name__=!0;class j extends A{constructor(e){super(),this.value=e}getStatus(){return g.Ready(this.value)}handle(e){return h.invoke(e,U.get(this.value)),null}eager(){this.value.isComputed()||U.get(this.value)}}j.__name__=!0;class N{static never(){return N.NEVER_INST}static first(e,t){let n=e;switch(n.getStatus()._hx_index){case 3:switch(t.getStatus()._hx_index){case 3:return n;case 4:return n;default:return n}break;case 4:return t;default:switch(t.getStatus()._hx_index){case 3:return t;case 4:return n;default:return new H(function(s){return new G(e.handle(s),t.handle(s))})}}}static flatMap(e,t,n){let s=e.getStatus();switch(s._hx_index){case 3:let r=s.result;return new H(function(a){return t(U.get(r)).handle(function(l){a(l)})});case 4:return N.never();default:return new H(function(a){let l=new ne;return new G(e.handle(function(c){let _=t(c).handle(a),x=l.link;x?.cancel(),l.link=_}),l)})}}static async(e,t){t==null&&(t=!1);let n=N.irreversible(e);return t||n.eager(),n}static irreversible(e){return new H(function(t){return e(t),null})}}var g=q["tink.core.FutureStatus"]={__ename__:!0,__constructs__:null,Suspended:{_hx_name:"Suspended",_hx_index:0,__enum__:"tink.core.FutureStatus",toString:w},Awaited:{_hx_name:"Awaited",_hx_index:1,__enum__:"tink.core.FutureStatus",toString:w},EagerlyAwaited:{_hx_name:"EagerlyAwaited",_hx_index:2,__enum__:"tink.core.FutureStatus",toString:w},Ready:(u=function(i){return{_hx_index:3,result:i,__enum__:"tink.core.FutureStatus",toString:w}},u._hx_name="Ready",u.__params__=["result"],u),NeverEver:{_hx_name:"NeverEver",_hx_index:4,__enum__:"tink.core.FutureStatus",toString:w}};g.__constructs__=[g.Suspended,g.Awaited,g.EagerlyAwaited,g.Ready,g.NeverEver];class H extends A{constructor(e){A._hx_skip_constructor=!0,super(),A._hx_skip_constructor=!1,this._hx_constructor(e)}_hx_constructor(e){this.status=g.Suspended,super._hx_constructor(),this.wakeup=e,this.callbacks=new re(!0);let t=this;this.callbacks.ondrain=function(){if(t.status==g.Awaited){t.status=g.Suspended;let n=t.link;n?.cancel(),t.link=null}},this.callbacks.onfill=function(){t.status==g.Suspended&&(t.status=g.Awaited,t.arm())}}getStatus(){return this.status}trigger(e){if(this.status._hx_index!=3){this.status=g.Ready(new R(e));let t=this.link;this.link=null,this.wakeup=null,this.callbacks.invoke(e),t?.cancel()}}handle(e){let t=this.status;if(t._hx_index==3)return h.invoke(e,U.get(t.result)),null;{let n=this.callbacks;if(n.disposeHandlers==null)return null;{let s=new se(e,n);if(n.cells.push(s),n.used++==0){let r=n.onfill;h.depth<500?(h.depth++,r(),h.depth--):h.defer(r)}return s}}}arm(){let e=this;this.link=this.wakeup(function(t){e.trigger(t)})}eager(){switch(this.status._hx_index){case 0:this.status=g.EagerlyAwaited,this.arm();break;case 1:this.status=g.EagerlyAwaited;break;default:}}}H.__name__=!0;class U{static get(e){return e.compute(),e.get()}}var o=q["tink.core.Outcome"]={__ename__:!0,__constructs__:null,Success:(u=function(i){return{_hx_index:0,data:i,__enum__:"tink.core.Outcome",toString:w}},u._hx_name="Success",u.__params__=["data"],u),Failure:(u=function(i){return{_hx_index:1,failure:i,__enum__:"tink.core.Outcome",toString:w}},u._hx_name="Failure",u.__params__=["failure"],u)};o.__constructs__=[o.Success,o.Failure];class ie{static next(e,t,n){return N.flatMap(e,function(s){switch(s._hx_index){case 0:return t(s.data);case 1:return new j(new R(o.Failure(s.failure)))}})}}class le{}le.__name__=!0;class ue{constructor(){}}ue.__name__=!0;class ae extends ue{constructor(e){super(),this.upcoming=e}}ae.__name__=!0;class V extends le{constructor(e){super(),this.target=e}static wrap(e,t){return new V(new ce(e,t))}}V.__name__=!0;class W extends ae{constructor(e){super(N.async(function(t){e.read().handle(function(n){let s=t,r;switch(n._hx_index){case 0:let a=n.data;r=a==null?P.End:P.Link(a,new W(e));break;case 1:r=P.Fail(n.failure);break}s(r)})},!0))}static wrap(e,t,n,s){return new W(new _e(e,t,n,s))}}W.__name__=!0;class _e{constructor(e,t,n,s){this.name=e,this.native=t,this.chunkSize=n;let r=N.async(function(a){t.once("end",function(){a(o.Success(null))}),t.once("error",function(l){a(o.Failure(new F(null,""+l.code+" - Failed reading from "+e+" because "+l.message,{fileName:"tink/io/nodejs/WrappedReadable.hx",lineNumber:22,className:"tink.io.nodejs.WrappedReadable",methodName:"new"})))})});r.eager(),this.end=r,s!=null&&this.end.handle(function(){process.nextTick(s)})}read(){let e=this;return N.first(N.async(function(t){let n=null;n=function(){try{let s=e.native.read(e.chunkSize);if(s==null)e.native.once("readable",n);else{let r=typeof s=="string"?new me(s):s;t(o.Success(new J(r)))}}catch(s){let r=b.caught(s).unwrap();t(o.Failure(F.withData(null,"Error while reading from "+e.name,r,{fileName:"tink/io/nodejs/WrappedReadable.hx",lineNumber:48,className:"tink.io.nodejs.WrappedReadable",methodName:"read"})))}},n()}),this.end)}}_e.__name__=!0;class ce{constructor(e,t){this.name=e,this.native=t,this.ended=N.async(function(n){t.once("end",function(){n(o.Success(!1))}),t.once("finish",function(){n(o.Success(!1))}),t.once("close",function(){n(o.Success(!1))}),t.on("error",function(s){n(o.Failure(new F(null,""+s.code+": "+s.message,{fileName:"tink/io/nodejs/WrappedWritable.hx",lineNumber:24,className:"tink.io.nodejs.WrappedWritable",methodName:"new"})))})})}}ce.__name__=!0;var P=q["tink.streams.Step"]={__ename__:!0,__constructs__:null,Link:(u=function(i,e){return{_hx_index:0,value:i,next:e,__enum__:"tink.streams.Step",toString:w}},u._hx_name="Link",u.__params__=["value","next"],u),Fail:(u=function(i){return{_hx_index:1,e:i,__enum__:"tink.streams.Step",toString:w}},u._hx_name="Fail",u.__params__=["e"],u),End:{_hx_name:"End",_hx_index:2,__enum__:"tink.streams.Step",toString:w}};P.__constructs__=[P.Link,P.Fail,P.End];function he(i){return i instanceof Array?new X(i):i.iterator()}typeof performance<"u"&&typeof performance.now=="function"&&(S.now=performance.now.bind(performance)),String.__name__=!0,Array.__name__=!0,I.__toStr={}.toString,h.depth=0,L._hx_skip_constructor=!1,A._hx_skip_constructor=!1,N.NEVER_INST=new A,M.main()})(global);
