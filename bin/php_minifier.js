#!/usr/bin/env node
var no=Object.create;var jt=Object.defineProperty;var oo=Object.getOwnPropertyDescriptor;var so=Object.getOwnPropertyNames;var io=Object.getPrototypeOf,ao=Object.prototype.hasOwnProperty;var B=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var O=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var co=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of so(t))!ao.call(e,o)&&o!==r&&jt(e,o,{get:()=>t[o],enumerable:!(n=oo(t,o))||n.enumerable});return e};var ze=(e,t,r)=>(r=e!=null?no(io(e)):{},co(t||!e||!e.__esModule?jt(r,"default",{value:e,enumerable:!0}):r,e));var ie=O((la,Wt)=>{"use strict";var uo=B("path"),Q="\\\\/",Ft=`[^${Q}]`,Y="\\.",lo="\\+",po="\\?",Se="\\/",fo="(?=.)",Ut="[^/]",Ve=`(?:${Se}|$)`,qt=`(?:^|${Se})`,Qe=`${Y}{1,2}${Ve}`,mo=`(?!${Y})`,ho=`(?!${qt}${Qe})`,yo=`(?!${Y}{0,1}${Ve})`,go=`(?!${Qe})`,bo=`[^.${Se}]`,xo=`${Ut}*?`,Kt={DOT_LITERAL:Y,PLUS_LITERAL:lo,QMARK_LITERAL:po,SLASH_LITERAL:Se,ONE_CHAR:fo,QMARK:Ut,END_ANCHOR:Ve,DOTS_SLASH:Qe,NO_DOT:mo,NO_DOTS:ho,NO_DOT_SLASH:yo,NO_DOTS_SLASH:go,QMARK_NO_DOT:bo,STAR:xo,START_ANCHOR:qt},Eo={...Kt,SLASH_LITERAL:`[${Q}]`,QMARK:Ft,STAR:`${Ft}*?`,DOTS_SLASH:`${Y}{1,2}(?:[${Q}]|$)`,NO_DOT:`(?!${Y})`,NO_DOTS:`(?!(?:^|[${Q}])${Y}{1,2}(?:[${Q}]|$))`,NO_DOT_SLASH:`(?!${Y}{0,1}(?:[${Q}]|$))`,NO_DOTS_SLASH:`(?!${Y}{1,2}(?:[${Q}]|$))`,QMARK_NO_DOT:`[^.${Q}]`,START_ANCHOR:`(?:^|[${Q}])`,END_ANCHOR:`(?:[${Q}]|$)`},So={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Wt.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:So,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:uo.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Eo:Kt}}});var Ae=O(U=>{"use strict";var Ao=B("path"),wo=process.platform==="win32",{REGEX_BACKSLASH:Ro,REGEX_REMOVE_BACKSLASH:_o,REGEX_SPECIAL_CHARS:Co,REGEX_SPECIAL_CHARS_GLOBAL:To}=ie();U.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);U.hasRegexChars=e=>Co.test(e);U.isRegexChar=e=>e.length===1&&U.hasRegexChars(e);U.escapeRegex=e=>e.replace(To,"\\$1");U.toPosixSlashes=e=>e.replace(Ro,"/");U.removeBackslashes=e=>e.replace(_o,t=>t==="\\"?"":t);U.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};U.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:wo===!0||Ao.sep==="\\";U.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?U.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};U.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};U.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",o=r.contains?"":"$",s=`${n}(?:${e})${o}`;return t.negated===!0&&(s=`(?:^(?!${s}).*$)`),s}});var er=O((fa,Jt)=>{"use strict";var Xt=Ae(),{CHAR_ASTERISK:Ye,CHAR_AT:$o,CHAR_BACKWARD_SLASH:ae,CHAR_COMMA:Po,CHAR_DOT:Ze,CHAR_EXCLAMATION_MARK:Je,CHAR_FORWARD_SLASH:Zt,CHAR_LEFT_CURLY_BRACE:et,CHAR_LEFT_PARENTHESES:tt,CHAR_LEFT_SQUARE_BRACKET:vo,CHAR_PLUS:Oo,CHAR_QUESTION_MARK:zt,CHAR_RIGHT_CURLY_BRACE:Io,CHAR_RIGHT_PARENTHESES:Vt,CHAR_RIGHT_SQUARE_BRACKET:Lo}=ie(),Qt=e=>e===Zt||e===ae,Yt=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?1/0:1)},Ho=(e,t)=>{let r=t||{},n=e.length-1,o=r.parts===!0||r.scanToEnd===!0,s=[],i=[],l=[],f=e,h=-1,m=0,x=0,E=!1,R=!1,g=!1,A=!1,D=!1,M=!1,G=!1,C=!1,q=!1,L=!1,X=0,N,y,_={value:"",depth:0,isGlob:!1},k=()=>h>=n,u=()=>f.charCodeAt(h+1),P=()=>(N=y,f.charCodeAt(++h));for(;h<n;){y=P();let j;if(y===ae){G=_.backslashes=!0,y=P(),y===et&&(M=!0);continue}if(M===!0||y===et){for(X++;k()!==!0&&(y=P());){if(y===ae){G=_.backslashes=!0,P();continue}if(y===et){X++;continue}if(M!==!0&&y===Ze&&(y=P())===Ze){if(E=_.isBrace=!0,g=_.isGlob=!0,L=!0,o===!0)continue;break}if(M!==!0&&y===Po){if(E=_.isBrace=!0,g=_.isGlob=!0,L=!0,o===!0)continue;break}if(y===Io&&(X--,X===0)){M=!1,E=_.isBrace=!0,L=!0;break}}if(o===!0)continue;break}if(y===Zt){if(s.push(h),i.push(_),_={value:"",depth:0,isGlob:!1},L===!0)continue;if(N===Ze&&h===m+1){m+=2;continue}x=h+1;continue}if(r.noext!==!0&&(y===Oo||y===$o||y===Ye||y===zt||y===Je)===!0&&u()===tt){if(g=_.isGlob=!0,A=_.isExtglob=!0,L=!0,y===Je&&h===m&&(q=!0),o===!0){for(;k()!==!0&&(y=P());){if(y===ae){G=_.backslashes=!0,y=P();continue}if(y===Vt){g=_.isGlob=!0,L=!0;break}}continue}break}if(y===Ye){if(N===Ye&&(D=_.isGlobstar=!0),g=_.isGlob=!0,L=!0,o===!0)continue;break}if(y===zt){if(g=_.isGlob=!0,L=!0,o===!0)continue;break}if(y===vo){for(;k()!==!0&&(j=P());){if(j===ae){G=_.backslashes=!0,P();continue}if(j===Lo){R=_.isBracket=!0,g=_.isGlob=!0,L=!0;break}}if(o===!0)continue;break}if(r.nonegate!==!0&&y===Je&&h===m){C=_.negated=!0,m++;continue}if(r.noparen!==!0&&y===tt){if(g=_.isGlob=!0,o===!0){for(;k()!==!0&&(y=P());){if(y===tt){G=_.backslashes=!0,y=P();continue}if(y===Vt){L=!0;break}}continue}break}if(g===!0){if(L=!0,o===!0)continue;break}}r.noext===!0&&(A=!1,g=!1);let T=f,Z="",a="";m>0&&(Z=f.slice(0,m),f=f.slice(m),x-=m),T&&g===!0&&x>0?(T=f.slice(0,x),a=f.slice(x)):g===!0?(T="",a=f):T=f,T&&T!==""&&T!=="/"&&T!==f&&Qt(T.charCodeAt(T.length-1))&&(T=T.slice(0,-1)),r.unescape===!0&&(a&&(a=Xt.removeBackslashes(a)),T&&G===!0&&(T=Xt.removeBackslashes(T)));let c={prefix:Z,input:e,start:m,base:T,glob:a,isBrace:E,isBracket:R,isGlob:g,isExtglob:A,isGlobstar:D,negated:C,negatedExtglob:q};if(r.tokens===!0&&(c.maxDepth=0,Qt(y)||i.push(_),c.tokens=i),r.parts===!0||r.tokens===!0){let j;for(let w=0;w<s.length;w++){let z=j?j+1:m,V=s[w],K=e.slice(z,V);r.tokens&&(w===0&&m!==0?(i[w].isPrefix=!0,i[w].value=Z):i[w].value=K,Yt(i[w]),c.maxDepth+=i[w].depth),(w!==0||K!=="")&&l.push(K),j=V}if(j&&j+1<e.length){let w=e.slice(j+1);l.push(w),r.tokens&&(i[i.length-1].value=w,Yt(i[i.length-1]),c.maxDepth+=i[i.length-1].depth)}c.slashes=s,c.parts=l}return c};Jt.exports=Ho});var nr=O((da,rr)=>{"use strict";var we=ie(),W=Ae(),{MAX_LENGTH:Re,POSIX_REGEX_SOURCE:No,REGEX_NON_SPECIAL_CHARS:ko,REGEX_SPECIAL_CHARS_BACKREF:Go,REPLACEMENTS:tr}=we,Bo=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch{return e.map(o=>W.escapeRegex(o)).join("..")}return r},te=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,rt=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=tr[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(Re,r.maxLength):Re,o=e.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},i=[s],l=r.capture?"":"?:",f=W.isWindows(t),h=we.globChars(f),m=we.extglobChars(h),{DOT_LITERAL:x,PLUS_LITERAL:E,SLASH_LITERAL:R,ONE_CHAR:g,DOTS_SLASH:A,NO_DOT:D,NO_DOT_SLASH:M,NO_DOTS_SLASH:G,QMARK:C,QMARK_NO_DOT:q,STAR:L,START_ANCHOR:X}=h,N=d=>`(${l}(?:(?!${X}${d.dot?A:x}).)*?)`,y=r.dot?"":D,_=r.dot?C:q,k=r.bash===!0?N(r):L;r.capture&&(k=`(${k})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let u={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:i};e=W.removePrefix(e,u),o=e.length;let P=[],T=[],Z=[],a=s,c,j=()=>u.index===o-1,w=u.peek=(d=1)=>e[u.index+d],z=u.advance=()=>e[++u.index]||"",V=()=>e.slice(u.index+1),K=(d="",$=0)=>{u.consumed+=d,u.index+=$},ge=d=>{u.output+=d.output!=null?d.output:d.value,K(d.value)},to=()=>{let d=1;for(;w()==="!"&&(w(2)!=="("||w(3)==="?");)z(),u.start++,d++;return d%2===0?!1:(u.negated=!0,u.start++,!0)},be=d=>{u[d]++,Z.push(d)},J=d=>{u[d]--,Z.pop()},S=d=>{if(a.type==="globstar"){let $=u.braces>0&&(d.type==="comma"||d.type==="brace"),p=d.extglob===!0||P.length&&(d.type==="pipe"||d.type==="paren");d.type!=="slash"&&d.type!=="paren"&&!$&&!p&&(u.output=u.output.slice(0,-a.output.length),a.type="star",a.value="*",a.output=k,u.output+=a.output)}if(P.length&&d.type!=="paren"&&(P[P.length-1].inner+=d.value),(d.value||d.output)&&ge(d),a&&a.type==="text"&&d.type==="text"){a.value+=d.value,a.output=(a.output||"")+d.value;return}d.prev=a,i.push(d),a=d},xe=(d,$)=>{let p={...m[$],conditions:1,inner:""};p.prev=a,p.parens=u.parens,p.output=u.output;let b=(r.capture?"(":"")+p.open;be("parens"),S({type:d,value:$,output:u.output?"":g}),S({type:"paren",extglob:!0,value:z(),output:b}),P.push(p)},ro=d=>{let $=d.close+(r.capture?")":""),p;if(d.type==="negate"){let b=k;if(d.inner&&d.inner.length>1&&d.inner.includes("/")&&(b=N(r)),(b!==k||j()||/^\)+$/.test(V()))&&($=d.close=`)$))${b}`),d.inner.includes("*")&&(p=V())&&/^\.[^\\/.]+$/.test(p)){let v=rt(p,{...t,fastpaths:!1}).output;$=d.close=`)${v})${b})`}d.prev.type==="bos"&&(u.negatedExtglob=!0)}S({type:"paren",extglob:!0,value:c,output:$}),J("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let d=!1,$=e.replace(Go,(p,b,v,F,H,Xe)=>F==="\\"?(d=!0,p):F==="?"?b?b+F+(H?C.repeat(H.length):""):Xe===0?_+(H?C.repeat(H.length):""):C.repeat(v.length):F==="."?x.repeat(v.length):F==="*"?b?b+F+(H?k:""):k:b?p:`\\${p}`);return d===!0&&(r.unescape===!0?$=$.replace(/\\/g,""):$=$.replace(/\\+/g,p=>p.length%2===0?"\\\\":p?"\\":"")),$===e&&r.contains===!0?(u.output=e,u):(u.output=W.wrapOutput($,u,t),u)}for(;!j();){if(c=z(),c==="\0")continue;if(c==="\\"){let p=w();if(p==="/"&&r.bash!==!0||p==="."||p===";")continue;if(!p){c+="\\",S({type:"text",value:c});continue}let b=/^\\+/.exec(V()),v=0;if(b&&b[0].length>2&&(v=b[0].length,u.index+=v,v%2!==0&&(c+="\\")),r.unescape===!0?c=z():c+=z(),u.brackets===0){S({type:"text",value:c});continue}}if(u.brackets>0&&(c!=="]"||a.value==="["||a.value==="[^")){if(r.posix!==!1&&c===":"){let p=a.value.slice(1);if(p.includes("[")&&(a.posix=!0,p.includes(":"))){let b=a.value.lastIndexOf("["),v=a.value.slice(0,b),F=a.value.slice(b+2),H=No[F];if(H){a.value=v+H,u.backtrack=!0,z(),!s.output&&i.indexOf(a)===1&&(s.output=g);continue}}}(c==="["&&w()!==":"||c==="-"&&w()==="]")&&(c=`\\${c}`),c==="]"&&(a.value==="["||a.value==="[^")&&(c=`\\${c}`),r.posix===!0&&c==="!"&&a.value==="["&&(c="^"),a.value+=c,ge({value:c});continue}if(u.quotes===1&&c!=='"'){c=W.escapeRegex(c),a.value+=c,ge({value:c});continue}if(c==='"'){u.quotes=u.quotes===1?0:1,r.keepQuotes===!0&&S({type:"text",value:c});continue}if(c==="("){be("parens"),S({type:"paren",value:c});continue}if(c===")"){if(u.parens===0&&r.strictBrackets===!0)throw new SyntaxError(te("opening","("));let p=P[P.length-1];if(p&&u.parens===p.parens+1){ro(P.pop());continue}S({type:"paren",value:c,output:u.parens?")":"\\)"}),J("parens");continue}if(c==="["){if(r.nobracket===!0||!V().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(te("closing","]"));c=`\\${c}`}else be("brackets");S({type:"bracket",value:c});continue}if(c==="]"){if(r.nobracket===!0||a&&a.type==="bracket"&&a.value.length===1){S({type:"text",value:c,output:`\\${c}`});continue}if(u.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(te("opening","["));S({type:"text",value:c,output:`\\${c}`});continue}J("brackets");let p=a.value.slice(1);if(a.posix!==!0&&p[0]==="^"&&!p.includes("/")&&(c=`/${c}`),a.value+=c,ge({value:c}),r.literalBrackets===!1||W.hasRegexChars(p))continue;let b=W.escapeRegex(a.value);if(u.output=u.output.slice(0,-a.value.length),r.literalBrackets===!0){u.output+=b,a.value=b;continue}a.value=`(${l}${b}|${a.value})`,u.output+=a.value;continue}if(c==="{"&&r.nobrace!==!0){be("braces");let p={type:"brace",value:c,output:"(",outputIndex:u.output.length,tokensIndex:u.tokens.length};T.push(p),S(p);continue}if(c==="}"){let p=T[T.length-1];if(r.nobrace===!0||!p){S({type:"text",value:c,output:c});continue}let b=")";if(p.dots===!0){let v=i.slice(),F=[];for(let H=v.length-1;H>=0&&(i.pop(),v[H].type!=="brace");H--)v[H].type!=="dots"&&F.unshift(v[H].value);b=Bo(F,r),u.backtrack=!0}if(p.comma!==!0&&p.dots!==!0){let v=u.output.slice(0,p.outputIndex),F=u.tokens.slice(p.tokensIndex);p.value=p.output="\\{",c=b="\\}",u.output=v;for(let H of F)u.output+=H.output||H.value}S({type:"brace",value:c,output:b}),J("braces"),T.pop();continue}if(c==="|"){P.length>0&&P[P.length-1].conditions++,S({type:"text",value:c});continue}if(c===","){let p=c,b=T[T.length-1];b&&Z[Z.length-1]==="braces"&&(b.comma=!0,p="|"),S({type:"comma",value:c,output:p});continue}if(c==="/"){if(a.type==="dot"&&u.index===u.start+1){u.start=u.index+1,u.consumed="",u.output="",i.pop(),a=s;continue}S({type:"slash",value:c,output:R});continue}if(c==="."){if(u.braces>0&&a.type==="dot"){a.value==="."&&(a.output=x);let p=T[T.length-1];a.type="dots",a.output+=c,a.value+=c,p.dots=!0;continue}if(u.braces+u.parens===0&&a.type!=="bos"&&a.type!=="slash"){S({type:"text",value:c,output:x});continue}S({type:"dot",value:c,output:x});continue}if(c==="?"){if(!(a&&a.value==="(")&&r.noextglob!==!0&&w()==="("&&w(2)!=="?"){xe("qmark",c);continue}if(a&&a.type==="paren"){let b=w(),v=c;if(b==="<"&&!W.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(a.value==="("&&!/[!=<:]/.test(b)||b==="<"&&!/<([!=]|\w+>)/.test(V()))&&(v=`\\${c}`),S({type:"text",value:c,output:v});continue}if(r.dot!==!0&&(a.type==="slash"||a.type==="bos")){S({type:"qmark",value:c,output:q});continue}S({type:"qmark",value:c,output:C});continue}if(c==="!"){if(r.noextglob!==!0&&w()==="("&&(w(2)!=="?"||!/[!=<:]/.test(w(3)))){xe("negate",c);continue}if(r.nonegate!==!0&&u.index===0){to();continue}}if(c==="+"){if(r.noextglob!==!0&&w()==="("&&w(2)!=="?"){xe("plus",c);continue}if(a&&a.value==="("||r.regex===!1){S({type:"plus",value:c,output:E});continue}if(a&&(a.type==="bracket"||a.type==="paren"||a.type==="brace")||u.parens>0){S({type:"plus",value:c});continue}S({type:"plus",value:E});continue}if(c==="@"){if(r.noextglob!==!0&&w()==="("&&w(2)!=="?"){S({type:"at",extglob:!0,value:c,output:""});continue}S({type:"text",value:c});continue}if(c!=="*"){(c==="$"||c==="^")&&(c=`\\${c}`);let p=ko.exec(V());p&&(c+=p[0],u.index+=p[0].length),S({type:"text",value:c});continue}if(a&&(a.type==="globstar"||a.star===!0)){a.type="star",a.star=!0,a.value+=c,a.output=k,u.backtrack=!0,u.globstar=!0,K(c);continue}let d=V();if(r.noextglob!==!0&&/^\([^?]/.test(d)){xe("star",c);continue}if(a.type==="star"){if(r.noglobstar===!0){K(c);continue}let p=a.prev,b=p.prev,v=p.type==="slash"||p.type==="bos",F=b&&(b.type==="star"||b.type==="globstar");if(r.bash===!0&&(!v||d[0]&&d[0]!=="/")){S({type:"star",value:c,output:""});continue}let H=u.braces>0&&(p.type==="comma"||p.type==="brace"),Xe=P.length&&(p.type==="pipe"||p.type==="paren");if(!v&&p.type!=="paren"&&!H&&!Xe){S({type:"star",value:c,output:""});continue}for(;d.slice(0,3)==="/**";){let Ee=e[u.index+4];if(Ee&&Ee!=="/")break;d=d.slice(3),K("/**",3)}if(p.type==="bos"&&j()){a.type="globstar",a.value+=c,a.output=N(r),u.output=a.output,u.globstar=!0,K(c);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&!F&&j()){u.output=u.output.slice(0,-(p.output+a.output).length),p.output=`(?:${p.output}`,a.type="globstar",a.output=N(r)+(r.strictSlashes?")":"|$)"),a.value+=c,u.globstar=!0,u.output+=p.output+a.output,K(c);continue}if(p.type==="slash"&&p.prev.type!=="bos"&&d[0]==="/"){let Ee=d[1]!==void 0?"|$":"";u.output=u.output.slice(0,-(p.output+a.output).length),p.output=`(?:${p.output}`,a.type="globstar",a.output=`${N(r)}${R}|${R}${Ee})`,a.value+=c,u.output+=p.output+a.output,u.globstar=!0,K(c+z()),S({type:"slash",value:"/",output:""});continue}if(p.type==="bos"&&d[0]==="/"){a.type="globstar",a.value+=c,a.output=`(?:^|${R}|${N(r)}${R})`,u.output=a.output,u.globstar=!0,K(c+z()),S({type:"slash",value:"/",output:""});continue}u.output=u.output.slice(0,-a.output.length),a.type="globstar",a.output=N(r),a.value+=c,u.output+=a.output,u.globstar=!0,K(c);continue}let $={type:"star",value:c,output:k};if(r.bash===!0){$.output=".*?",(a.type==="bos"||a.type==="slash")&&($.output=y+$.output),S($);continue}if(a&&(a.type==="bracket"||a.type==="paren")&&r.regex===!0){$.output=c,S($);continue}(u.index===u.start||a.type==="slash"||a.type==="dot")&&(a.type==="dot"?(u.output+=M,a.output+=M):r.dot===!0?(u.output+=G,a.output+=G):(u.output+=y,a.output+=y),w()!=="*"&&(u.output+=g,a.output+=g)),S($)}for(;u.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(te("closing","]"));u.output=W.escapeLast(u.output,"["),J("brackets")}for(;u.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(te("closing",")"));u.output=W.escapeLast(u.output,"("),J("parens")}for(;u.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(te("closing","}"));u.output=W.escapeLast(u.output,"{"),J("braces")}if(r.strictSlashes!==!0&&(a.type==="star"||a.type==="bracket")&&S({type:"maybe_slash",value:"",output:`${R}?`}),u.backtrack===!0){u.output="";for(let d of u.tokens)u.output+=d.output!=null?d.output:d.value,d.suffix&&(u.output+=d.suffix)}return u};rt.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(Re,r.maxLength):Re,o=e.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);e=tr[e]||e;let s=W.isWindows(t),{DOT_LITERAL:i,SLASH_LITERAL:l,ONE_CHAR:f,DOTS_SLASH:h,NO_DOT:m,NO_DOTS:x,NO_DOTS_SLASH:E,STAR:R,START_ANCHOR:g}=we.globChars(s),A=r.dot?x:m,D=r.dot?E:m,M=r.capture?"":"?:",G={negated:!1,prefix:""},C=r.bash===!0?".*?":R;r.capture&&(C=`(${C})`);let q=y=>y.noglobstar===!0?C:`(${M}(?:(?!${g}${y.dot?h:i}).)*?)`,L=y=>{switch(y){case"*":return`${A}${f}${C}`;case".*":return`${i}${f}${C}`;case"*.*":return`${A}${C}${i}${f}${C}`;case"*/*":return`${A}${C}${l}${f}${D}${C}`;case"**":return A+q(r);case"**/*":return`(?:${A}${q(r)}${l})?${D}${f}${C}`;case"**/*.*":return`(?:${A}${q(r)}${l})?${D}${C}${i}${f}${C}`;case"**/.*":return`(?:${A}${q(r)}${l})?${i}${f}${C}`;default:{let _=/^(.*?)\.(\w+)$/.exec(y);if(!_)return;let k=L(_[1]);return k?k+i+_[2]:void 0}}},X=W.removePrefix(e,G),N=L(X);return N&&r.strictSlashes!==!0&&(N+=`${l}?`),N};rr.exports=rt});var sr=O((ma,or)=>{"use strict";var Do=B("path"),Mo=er(),nt=nr(),ot=Ae(),jo=ie(),Fo=e=>e&&typeof e=="object"&&!Array.isArray(e),I=(e,t,r=!1)=>{if(Array.isArray(e)){let m=e.map(E=>I(E,t,r));return E=>{for(let R of m){let g=R(E);if(g)return g}return!1}}let n=Fo(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let o=t||{},s=ot.isWindows(t),i=n?I.compileRe(e,t):I.makeRe(e,t,!1,!0),l=i.state;delete i.state;let f=()=>!1;if(o.ignore){let m={...t,ignore:null,onMatch:null,onResult:null};f=I(o.ignore,m,r)}let h=(m,x=!1)=>{let{isMatch:E,match:R,output:g}=I.test(m,i,t,{glob:e,posix:s}),A={glob:e,state:l,regex:i,posix:s,input:m,output:g,match:R,isMatch:E};return typeof o.onResult=="function"&&o.onResult(A),E===!1?(A.isMatch=!1,x?A:!1):f(m)?(typeof o.onIgnore=="function"&&o.onIgnore(A),A.isMatch=!1,x?A:!1):(typeof o.onMatch=="function"&&o.onMatch(A),x?A:!0)};return r&&(h.state=l),h};I.test=(e,t,r,{glob:n,posix:o}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=r||{},i=s.format||(o?ot.toPosixSlashes:null),l=e===n,f=l&&i?i(e):e;return l===!1&&(f=i?i(e):e,l=f===n),(l===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?l=I.matchBase(e,t,r,o):l=t.exec(f)),{isMatch:!!l,match:l,output:f}};I.matchBase=(e,t,r,n=ot.isWindows(r))=>(t instanceof RegExp?t:I.makeRe(t,r)).test(Do.basename(e));I.isMatch=(e,t,r)=>I(t,r)(e);I.parse=(e,t)=>Array.isArray(e)?e.map(r=>I.parse(r,t)):nt(e,{...t,fastpaths:!1});I.scan=(e,t)=>Mo(e,t);I.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let o=t||{},s=o.contains?"":"^",i=o.contains?"":"$",l=`${s}(?:${e.output})${i}`;e&&e.negated===!0&&(l=`^(?!${l}).*$`);let f=I.toRegex(l,t);return n===!0&&(f.state=e),f};I.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(o.output=nt.fastpaths(e,t)),o.output||(o=nt(e,t)),I.compileRe(o,t,r,n)};I.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};I.constants=jo;or.exports=I});var ar=O((ha,ir)=>{"use strict";ir.exports=sr()});var hr=O((ya,mr)=>{"use strict";var ue=B("fs"),{Readable:Uo}=B("stream"),ce=B("path"),{promisify:$e}=B("util"),st=ar(),qo=$e(ue.readdir),Ko=$e(ue.stat),cr=$e(ue.lstat),Wo=$e(ue.realpath),Xo="!",fr="READDIRP_RECURSIVE_ERROR",zo=new Set(["ENOENT","EPERM","EACCES","ELOOP",fr]),it="files",dr="directories",Ce="files_directories",_e="all",ur=[it,dr,Ce,_e],Vo=e=>zo.has(e.code),[lr,Qo]=process.versions.node.split(".").slice(0,2).map(e=>Number.parseInt(e,10)),Yo=process.platform==="win32"&&(lr>10||lr===10&&Qo>=5),pr=e=>{if(e!==void 0){if(typeof e=="function")return e;if(typeof e=="string"){let t=st(e.trim());return r=>t(r.basename)}if(Array.isArray(e)){let t=[],r=[];for(let n of e){let o=n.trim();o.charAt(0)===Xo?r.push(st(o.slice(1))):t.push(st(o))}return r.length>0?t.length>0?n=>t.some(o=>o(n.basename))&&!r.some(o=>o(n.basename)):n=>!r.some(o=>o(n.basename)):n=>t.some(o=>o(n.basename))}}},Te=class e extends Uo{static get defaultOptions(){return{root:".",fileFilter:t=>!0,directoryFilter:t=>!0,type:it,lstat:!1,depth:2147483648,alwaysStat:!1}}constructor(t={}){super({objectMode:!0,autoDestroy:!0,highWaterMark:t.highWaterMark||4096});let r={...e.defaultOptions,...t},{root:n,type:o}=r;this._fileFilter=pr(r.fileFilter),this._directoryFilter=pr(r.directoryFilter);let s=r.lstat?cr:Ko;Yo?this._stat=i=>s(i,{bigint:!0}):this._stat=s,this._maxDepth=r.depth,this._wantsDir=[dr,Ce,_e].includes(o),this._wantsFile=[it,Ce,_e].includes(o),this._wantsEverything=o===_e,this._root=ce.resolve(n),this._isDirent="Dirent"in ue&&!r.alwaysStat,this._statsProp=this._isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent},this.parents=[this._exploreDir(n,1)],this.reading=!1,this.parent=void 0}async _read(t){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&t>0;){let{path:r,depth:n,files:o=[]}=this.parent||{};if(o.length>0){let s=o.splice(0,t).map(i=>this._formatEntry(i,r));for(let i of await Promise.all(s)){if(this.destroyed)return;let l=await this._getEntryType(i);l==="directory"&&this._directoryFilter(i)?(n<=this._maxDepth&&this.parents.push(this._exploreDir(i.fullPath,n+1)),this._wantsDir&&(this.push(i),t--)):(l==="file"||this._includeAsFile(i))&&this._fileFilter(i)&&this._wantsFile&&(this.push(i),t--)}}else{let s=this.parents.pop();if(!s){this.push(null);break}if(this.parent=await s,this.destroyed)return}}}catch(r){this.destroy(r)}finally{this.reading=!1}}}async _exploreDir(t,r){let n;try{n=await qo(t,this._rdOptions)}catch(o){this._onError(o)}return{files:n,depth:r,path:t}}async _formatEntry(t,r){let n;try{let o=this._isDirent?t.name:t,s=ce.resolve(ce.join(r,o));n={path:ce.relative(this._root,s),fullPath:s,basename:o},n[this._statsProp]=this._isDirent?t:await this._stat(s)}catch(o){this._onError(o)}return n}_onError(t){Vo(t)&&!this.destroyed?this.emit("warn",t):this.destroy(t)}async _getEntryType(t){let r=t&&t[this._statsProp];if(r){if(r.isFile())return"file";if(r.isDirectory())return"directory";if(r&&r.isSymbolicLink()){let n=t.fullPath;try{let o=await Wo(n),s=await cr(o);if(s.isFile())return"file";if(s.isDirectory()){let i=o.length;if(n.startsWith(o)&&n.substr(i,1)===ce.sep){let l=new Error(`Circular symlink detected: "${n}" points to "${o}"`);return l.code=fr,this._onError(l)}return"directory"}}catch(o){this._onError(o)}}}}_includeAsFile(t){let r=t&&t[this._statsProp];return r&&this._wantsEverything&&!r.isDirectory()}},re=(e,t={})=>{let r=t.entryType||t.type;if(r==="both"&&(r=Ce),r&&(t.type=r),e){if(typeof e!="string")throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)");if(r&&!ur.includes(r))throw new Error(`readdirp: Invalid type passed. Use one of ${ur.join(", ")}`)}else throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");return t.root=e,new Te(t)},Zo=(e,t={})=>new Promise((r,n)=>{let o=[];re(e,t).on("data",s=>o.push(s)).on("end",()=>r(o)).on("error",s=>n(s))});re.promise=Zo;re.ReaddirpStream=Te;re.default=re;mr.exports=re});var Ar=O((xa,Sr)=>{Sr.exports=Er;Er.sync=ts;var br=B("fs");function es(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}function xr(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:es(t,r)}function Er(e,t,r){br.stat(e,function(n,o){r(n,n?!1:xr(o,e,t))})}function ts(e,t){return xr(br.statSync(e),e,t)}});var Tr=O((Ea,Cr)=>{Cr.exports=Rr;Rr.sync=rs;var wr=B("fs");function Rr(e,t,r){wr.stat(e,function(n,o){r(n,n?!1:_r(o,t))})}function rs(e,t){return _r(wr.statSync(e),t)}function _r(e,t){return e.isFile()&&ns(e,t)}function ns(e,t){var r=e.mode,n=e.uid,o=e.gid,s=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),i=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),l=parseInt("100",8),f=parseInt("010",8),h=parseInt("001",8),m=l|f,x=r&h||r&f&&o===i||r&l&&n===s||r&m&&s===0;return x}});var Pr=O((Aa,$r)=>{var Sa=B("fs"),Pe;process.platform==="win32"||global.TESTING_WINDOWS?Pe=Ar():Pe=Tr();$r.exports=at;at.sync=os;function at(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,o){at(e,t||{},function(s,i){s?o(s):n(i)})})}Pe(e,t||{},function(n,o){n&&(n.code==="EACCES"||t&&t.ignoreErrors)&&(n=null,o=!1),r(n,o)})}function os(e,t){try{return Pe.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var kr=O((wa,Nr)=>{var ne=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",vr=B("path"),ss=ne?";":":",Or=Pr(),Ir=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),Lr=(e,t)=>{let r=t.colon||ss,n=e.match(/\//)||ne&&e.match(/\\/)?[""]:[...ne?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],o=ne?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",s=ne?o.split(r):[""];return ne&&e.indexOf(".")!==-1&&s[0]!==""&&s.unshift(""),{pathEnv:n,pathExt:s,pathExtExe:o}},Hr=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:n,pathExt:o,pathExtExe:s}=Lr(e,t),i=[],l=h=>new Promise((m,x)=>{if(h===n.length)return t.all&&i.length?m(i):x(Ir(e));let E=n[h],R=/^".*"$/.test(E)?E.slice(1,-1):E,g=vr.join(R,e),A=!R&&/^\.[\\\/]/.test(e)?e.slice(0,2)+g:g;m(f(A,h,0))}),f=(h,m,x)=>new Promise((E,R)=>{if(x===o.length)return E(l(m+1));let g=o[x];Or(h+g,{pathExt:s},(A,D)=>{if(!A&&D)if(t.all)i.push(h+g);else return E(h+g);return E(f(h,m,x+1))})});return r?l(0).then(h=>r(null,h),r):l(0)},is=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:n,pathExtExe:o}=Lr(e,t),s=[];for(let i=0;i<r.length;i++){let l=r[i],f=/^".*"$/.test(l)?l.slice(1,-1):l,h=vr.join(f,e),m=!f&&/^\.[\\\/]/.test(e)?e.slice(0,2)+h:h;for(let x=0;x<n.length;x++){let E=m+n[x];try{if(Or.sync(E,{pathExt:o}))if(t.all)s.push(E);else return E}catch{}}}if(t.all&&s.length)return s;if(t.nothrow)return null;throw Ir(e)};Nr.exports=Hr;Hr.sync=is});var Br=O((Ra,ct)=>{"use strict";var Gr=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};ct.exports=Gr;ct.exports.default=Gr});var Fr=O((_a,jr)=>{"use strict";var Dr=B("path"),as=kr(),cs=Br();function Mr(e,t){let r=e.options.env||process.env,n=process.cwd(),o=e.options.cwd!=null,s=o&&process.chdir!==void 0&&!process.chdir.disabled;if(s)try{process.chdir(e.options.cwd)}catch{}let i;try{i=as.sync(e.command,{path:r[cs({env:r})],pathExt:t?Dr.delimiter:void 0})}catch{}finally{s&&process.chdir(n)}return i&&(i=Dr.resolve(o?e.options.cwd:"",i)),i}function us(e){return Mr(e)||Mr(e,!0)}jr.exports=us});var Ur=O((Ca,lt)=>{"use strict";var ut=/([()\][%!^"`<>&|;, *?])/g;function ls(e){return e=e.replace(ut,"^$1"),e}function ps(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(ut,"^$1"),t&&(e=e.replace(ut,"^$1")),e}lt.exports.command=ls;lt.exports.argument=ps});var Kr=O((Ta,qr)=>{"use strict";qr.exports=/^#!(.*)/});var Xr=O(($a,Wr)=>{"use strict";var fs=Kr();Wr.exports=(e="")=>{let t=e.match(fs);if(!t)return null;let[r,n]=t[0].replace(/#! ?/,"").split(" "),o=r.split("/").pop();return o==="env"?n:n?`${o} ${n}`:o}});var Vr=O((Pa,zr)=>{"use strict";var pt=B("fs"),ds=Xr();function ms(e){let r=Buffer.alloc(150),n;try{n=pt.openSync(e,"r"),pt.readSync(n,r,0,150,0),pt.closeSync(n)}catch{}return ds(r.toString())}zr.exports=ms});var Jr=O((va,Zr)=>{"use strict";var hs=B("path"),Qr=Fr(),Yr=Ur(),ys=Vr(),gs=process.platform==="win32",bs=/\.(?:com|exe)$/i,xs=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function Es(e){e.file=Qr(e);let t=e.file&&ys(e.file);return t?(e.args.unshift(e.file),e.command=t,Qr(e)):e.file}function Ss(e){if(!gs)return e;let t=Es(e),r=!bs.test(t);if(e.options.forceShell||r){let n=xs.test(t);e.command=hs.normalize(e.command),e.command=Yr.command(e.command),e.args=e.args.map(s=>Yr.argument(s,n));let o=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${o}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function As(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let n={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?n:Ss(n)}Zr.exports=As});var rn=O((Oa,tn)=>{"use strict";var ft=process.platform==="win32";function dt(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function ws(e,t){if(!ft)return;let r=e.emit;e.emit=function(n,o){if(n==="exit"){let s=en(o,t,"spawn");if(s)return r.call(e,"error",s)}return r.apply(e,arguments)}}function en(e,t){return ft&&e===1&&!t.file?dt(t.original,"spawn"):null}function Rs(e,t){return ft&&e===1&&!t.file?dt(t.original,"spawnSync"):null}tn.exports={hookChildProcess:ws,verifyENOENT:en,verifyENOENTSync:Rs,notFoundError:dt}});var sn=O((Ia,oe)=>{"use strict";var nn=B("child_process"),mt=Jr(),ht=rn();function on(e,t,r){let n=mt(e,t,r),o=nn.spawn(n.command,n.args,n.options);return ht.hookChildProcess(o,n),o}function _s(e,t,r){let n=mt(e,t,r),o=nn.spawnSync(n.command,n.args,n.options);return o.error=o.error||ht.verifyENOENTSync(o.status,n),o}oe.exports=on;oe.exports.spawn=on;oe.exports.sync=_s;oe.exports._parse=mt;oe.exports._enoent=ht});var Hn=O((kc,Ln)=>{"use strict";var{PassThrough:Si}=B("stream");Ln.exports=function(){var e=[],t=new Si({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=n,t.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(r),t;function r(s){return Array.isArray(s)?(s.forEach(r),this):(e.push(s),s.once("end",o.bind(null,s)),s.once("error",t.emit.bind(t,"error")),s.pipe(t,{end:!1}),this)}function n(){return e.length==0}function o(s){e=e.filter(function(i){return i!==s}),!e.length&&t.readable&&t.end()}}});var eo=ze(hr(),1);import ye from"node:console";import{access as ta,mkdir as ra,writeFile as na}from"node:fs/promises";import{dirname as oa,join as sa,resolve as Zn}from"node:path";import Jn from"node:process";import{parseArgs as ia}from"node:util";var yr={bugs:"https://github.com/cedx/php-minifier/issues",description:"Minify PHP source code by removing comments and whitespace.",homepage:"https://github.com/cedx/php-minifier",license:"MIT",name:"@cedx/php-minifier",repository:"cedx/php-minifier",type:"module",version:"2.0.0",author:{email:"cedric@belin.io",name:"C\xE9dric Belin",url:"https://belin.io"},bin:{php_minifier:"./bin/php_minifier.js"},dependencies:{execa:"^8.0.1","fancy-log":"^2.0.0","get-port":"^7.0.0","plugin-error":"^2.0.1",readdirp:"^3.6.0"},devDependencies:{"@types/fancy-log":"^2.0.2","@types/node":"^20.11.7","@types/vinyl":"^2.0.11","@typescript-eslint/eslint-plugin":"^6.19.1","@typescript-eslint/parser":"^6.19.1",esbuild:"^0.19.12",eslint:"^8.56.0",typedoc:"^0.25.7",typescript:"^5.3.3",vinyl:"^3.0.0"},engines:{node:">=20.0.0"},exports:{types:"./lib/index.d.ts",import:"./lib/index.js"},files:["lib/","src/","www/"],imports:{"#phpMinifier":{types:"./lib/index.d.ts",import:"./lib/index.js"}},keywords:["compress","gulp","gulpplugin","minify","php"],peerDependencies:{gulp:">=4.0.0"},scripts:{build:"tsc --project src/tsconfig.json && esbuild --allow-overwrite --bundle --format=esm --legal-comments=none --log-level=warning --minify --outfile=bin/php_minifier.js --platform=node src/cli/main.ts",clean:"node tool/clean.js",dist:"npm run clean && npm run build && node tool/dist.js && git update-index --chmod=+x bin/php_minifier.js",doc:"typedoc --options etc/typedoc.js && node tool/doc.js",lint:"tsc --project tsconfig.json && eslint --config=etc/eslint.cjs src test tool",postpublish:"node tool/publish.js",prepack:"npm run dist",start:"npm run build && node bin/php_minifier.js --help",test:"npm run build && node --test --test-reporter=spec"}};var gr=`
Minify PHP source code by removing comments and whitespace.

Usage:
  php_minifier [options] <input> <output>

Arguments:
  input            The path to the input directory.
  output           The path to the output directory.

Options:
  -b, --binary     The path to the PHP executable.
  -e, --extension  The extension of the PHP files to process. Defaults to "php".
  -m, --mode       The operation mode of the minifier. Defaults to "safe".
  -s, --silent     Value indicating whether to silence the minifier output.
  -h, --help       Display this help.
  -v, --version    Output the version number.
`;import{normalize as Qi,resolve as Yi}from"node:path";import{fileURLToPath as Zi}from"node:url";var Xn=ze(sn(),1);import{Buffer as Di}from"node:buffer";import Mi from"node:path";import Dt from"node:child_process";import Ue from"node:process";function yt(e){let t=typeof e=="string"?`
`:10,r=typeof e=="string"?"\r":13;return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}import Oe from"node:process";import le from"node:path";import an from"node:url";function ve(e={}){let{env:t=process.env,platform:r=process.platform}=e;return r!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function Cs(e={}){let{cwd:t=Oe.cwd(),path:r=Oe.env[ve()],execPath:n=Oe.execPath}=e,o,s=n instanceof URL?an.fileURLToPath(n):n,i=t instanceof URL?an.fileURLToPath(t):t,l=le.resolve(i),f=[];for(;o!==l;)f.push(le.join(l,"node_modules/.bin")),o=l,l=le.resolve(l,"..");return f.push(le.resolve(i,s,"..")),[...f,r].join(le.delimiter)}function cn({env:e=Oe.env,...t}={}){e={...e};let r=ve({env:e});return t.path=e[r],e[r]=Cs(t),e}var Ts=(e,t,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let o=Object.getOwnPropertyDescriptor(e,r),s=Object.getOwnPropertyDescriptor(t,r);!$s(o,s)&&n||Object.defineProperty(e,r,s)},$s=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},Ps=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},vs=(e,t)=>`/* Wrapped ${e}*/
${t}`,Os=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Is=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Ls=(e,t,r)=>{let n=r===""?"":`with ${r.trim()}() `,o=vs.bind(null,n,t.toString());Object.defineProperty(o,"name",Is),Object.defineProperty(e,"toString",{...Os,value:o})};function gt(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:n}=e;for(let o of Reflect.ownKeys(t))Ts(e,t,o,r);return Ps(e,t),Ls(e,t,n),e}var Ie=new WeakMap,un=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,n=0,o=e.displayName||e.name||"<anonymous>",s=function(...i){if(Ie.set(s,++n),n===1)r=e.apply(this,i),e=null;else if(t.throw===!0)throw new Error(`Function \`${o}\` can only be called once`);return r};return gt(s,e),Ie.set(s,n),s};un.callCount=e=>{if(!Ie.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return Ie.get(e)};var ln=un;import Us from"node:process";import{constants as Gs}from"node:os";var pn=()=>{let e=dn-fn+1;return Array.from({length:e},Hs)},Hs=(e,t)=>({name:`SIGRT${t+1}`,number:fn+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}),fn=34,dn=64;import{constants as Ns}from"node:os";var mn=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var bt=()=>{let e=pn();return[...mn,...e].map(ks)},ks=({name:e,number:t,description:r,action:n,forced:o=!1,standard:s})=>{let{signals:{[e]:i}}=Ns,l=i!==void 0;return{name:e,number:l?i:t,description:r,supported:l,action:n,forced:o,standard:s}};var Bs=()=>{let e=bt();return Object.fromEntries(e.map(Ds))},Ds=({name:e,number:t,description:r,supported:n,action:o,forced:s,standard:i})=>[e,{name:e,number:t,description:r,supported:n,action:o,forced:s,standard:i}],hn=Bs(),Ms=()=>{let e=bt(),t=65,r=Array.from({length:t},(n,o)=>js(o,e));return Object.assign({},...r)},js=(e,t)=>{let r=Fs(e,t);if(r===void 0)return{};let{name:n,description:o,supported:s,action:i,forced:l,standard:f}=r;return{[e]:{name:n,number:e,description:o,supported:s,action:i,forced:l,standard:f}}},Fs=(e,t)=>{let r=t.find(({name:n})=>Gs.signals[n]===e);return r!==void 0?r:t.find(n=>n.number===e)},Ya=Ms();var qs=({timedOut:e,timeout:t,errorCode:r,signal:n,signalDescription:o,exitCode:s,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${o})`:s!==void 0?`failed with exit code ${s}`:"failed",pe=({stdout:e,stderr:t,all:r,error:n,signal:o,exitCode:s,command:i,escapedCommand:l,timedOut:f,isCanceled:h,killed:m,parsed:{options:{timeout:x,cwd:E=Us.cwd()}}})=>{s=s===null?void 0:s,o=o===null?void 0:o;let R=o===void 0?void 0:hn[o].description,g=n&&n.code,D=`Command ${qs({timedOut:f,timeout:x,errorCode:g,signal:o,signalDescription:R,exitCode:s,isCanceled:h})}: ${i}`,M=Object.prototype.toString.call(n)==="[object Error]",G=M?`${D}
${n.message}`:D,C=[G,t,e].filter(Boolean).join(`
`);return M?(n.originalMessage=n.message,n.message=C):n=new Error(C),n.shortMessage=G,n.command=i,n.escapedCommand=l,n.exitCode=s,n.signal=o,n.signalDescription=R,n.stdout=e,n.stderr=t,n.cwd=E,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!f,n.isCanceled=h,n.killed=m&&!f,n};var Le=["stdin","stdout","stderr"],Ks=e=>Le.some(t=>e[t]!==void 0),yn=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return Le.map(n=>e[n]);if(Ks(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Le.map(n=>`\`${n}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,Le.length);return Array.from({length:r},(n,o)=>t[o])};import zs from"node:os";var ee=[];ee.push("SIGHUP","SIGINT","SIGTERM");process.platform!=="win32"&&ee.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&ee.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT");var He=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",xt=Symbol.for("signal-exit emitter"),Et=globalThis,Ws=Object.defineProperty.bind(Object),St=class{emitted={afterExit:!1,exit:!1};listeners={afterExit:[],exit:[]};count=0;id=Math.random();constructor(){if(Et[xt])return Et[xt];Ws(Et,xt,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,r){this.listeners[t].push(r)}removeListener(t,r){let n=this.listeners[t],o=n.indexOf(r);o!==-1&&(o===0&&n.length===1?n.length=0:n.splice(o,1))}emit(t,r,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let o=!1;for(let s of this.listeners[t])o=s(r,n)===!0||o;return t==="exit"&&(o=this.emit("afterExit",r,n)||o),o}},Ne=class{},Xs=e=>({onExit(t,r){return e.onExit(t,r)},load(){return e.load()},unload(){return e.unload()}}),At=class extends Ne{onExit(){return()=>{}}load(){}unload(){}},wt=class extends Ne{#n=Rt.platform==="win32"?"SIGINT":"SIGHUP";#t=new St;#e;#r;#i;#s={};#o=!1;constructor(t){super(),this.#e=t,this.#s={};for(let r of ee)this.#s[r]=()=>{let n=this.#e.listeners(r),{count:o}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(o+=s.__signal_exit_emitter__.count),n.length===o){this.unload();let i=this.#t.emit("exit",null,r),l=r==="SIGHUP"?this.#n:r;i||t.kill(t.pid,l)}};this.#i=t.reallyExit,this.#r=t.emit}onExit(t,r){if(!He(this.#e))return()=>{};this.#o===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#o){this.#o=!0,this.#t.count+=1;for(let t of ee)try{let r=this.#s[t];r&&this.#e.on(t,r)}catch{}this.#e.emit=(t,...r)=>this.#c(t,...r),this.#e.reallyExit=t=>this.#a(t)}}unload(){this.#o&&(this.#o=!1,ee.forEach(t=>{let r=this.#s[t];if(!r)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,r)}catch{}}),this.#e.emit=this.#r,this.#e.reallyExit=this.#i,this.#t.count-=1)}#a(t){return He(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#c(t,...r){let n=this.#r;if(t==="exit"&&He(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let o=n.call(this.#e,t,...r);return this.#t.emit("exit",this.#e.exitCode,null),o}else return n.call(this.#e,t,...r)}},Rt=globalThis.process,{onExit:gn,load:sc,unload:ic}=Xs(He(Rt)?new wt(Rt):new At);var Vs=1e3*5,bn=(e,t="SIGTERM",r={})=>{let n=e(t);return Qs(e,t,r,n),n},Qs=(e,t,r,n)=>{if(!Ys(t,r,n))return;let o=Js(r),s=setTimeout(()=>{e("SIGKILL")},o);s.unref&&s.unref()},Ys=(e,{forceKillAfterTimeout:t},r)=>Zs(e)&&t!==!1&&r,Zs=e=>e===zs.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Js=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return Vs;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},xn=(e,t)=>{e.kill()&&(t.isCanceled=!0)},ei=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},En=(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(t===0||t===void 0)return n;let o,s=new Promise((l,f)=>{o=setTimeout(()=>{ei(e,r,f)},t)}),i=n.finally(()=>{clearTimeout(o)});return Promise.race([s,i])},Sn=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},An=async(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;let o=gn(()=>{e.kill()});return n.finally(()=>{o()})};import{createWriteStream as ti}from"node:fs";import{ChildProcess as ri}from"node:child_process";function ke(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function _t(e){return ke(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}var ni=e=>e instanceof ri&&typeof e.then=="function",Ct=(e,t,r)=>{if(typeof r=="string")return e[t].pipe(ti(r)),e;if(_t(r))return e[t].pipe(r),e;if(!ni(r))throw new TypeError("The second argument must be a string, a stream or an Execa child process.");if(!_t(r.stdin))throw new TypeError("The target child process's stdin must be available.");return e[t].pipe(r.stdin),r},wn=e=>{e.stdout!==null&&(e.pipeStdout=Ct.bind(void 0,e,"stdout")),e.stderr!==null&&(e.pipeStderr=Ct.bind(void 0,e,"stderr")),e.all!==void 0&&(e.pipeAll=Ct.bind(void 0,e,"all"))};import{createReadStream as Ai,readFileSync as wi}from"node:fs";import{setTimeout as Ri}from"node:timers/promises";var fe=async(e,{init:t,convertChunk:r,getSize:n,truncateChunk:o,addChunk:s,getFinalChunk:i,finalize:l},{maxBuffer:f=Number.POSITIVE_INFINITY}={})=>{if(!si(e))throw new Error("The first argument must be a Readable, a ReadableStream, or an async iterable.");let h=t();h.length=0;try{for await(let m of e){let x=ii(m),E=r[x](m,h);Cn({convertedChunk:E,state:h,getSize:n,truncateChunk:o,addChunk:s,maxBuffer:f})}return oi({state:h,convertChunk:r,getSize:n,truncateChunk:o,addChunk:s,getFinalChunk:i,maxBuffer:f}),l(h)}catch(m){throw m.bufferedData=l(h),m}},oi=({state:e,getSize:t,truncateChunk:r,addChunk:n,getFinalChunk:o,maxBuffer:s})=>{let i=o(e);i!==void 0&&Cn({convertedChunk:i,state:e,getSize:t,truncateChunk:r,addChunk:n,maxBuffer:s})},Cn=({convertedChunk:e,state:t,getSize:r,truncateChunk:n,addChunk:o,maxBuffer:s})=>{let i=r(e),l=t.length+i;if(l<=s){Rn(e,t,o,l);return}let f=n(e,s-t.length);throw f!==void 0&&Rn(f,t,o,s),new Ge},Rn=(e,t,r,n)=>{t.contents=r(e,t,n),t.length=n},si=e=>typeof e=="object"&&e!==null&&typeof e[Symbol.asyncIterator]=="function",ii=e=>{let t=typeof e;if(t==="string")return"string";if(t!=="object"||e===null)return"others";if(globalThis.Buffer?.isBuffer(e))return"buffer";let r=_n.call(e);return r==="[object ArrayBuffer]"?"arrayBuffer":r==="[object DataView]"?"dataView":Number.isInteger(e.byteLength)&&Number.isInteger(e.byteOffset)&&_n.call(e.buffer)==="[object ArrayBuffer]"?"typedArray":"others"},{toString:_n}=Object.prototype,Ge=class extends Error{name="MaxBufferError";constructor(){super("maxBuffer exceeded")}};var Tt=e=>e,$t=()=>{},Pt=({contents:e})=>e,Be=e=>{throw new Error(`Streams in object mode are not supported: ${String(e)}`)},De=e=>e.length;async function vt(e,t){return fe(e,hi,t)}var ai=()=>({contents:new ArrayBuffer(0)}),ci=e=>ui.encode(e),ui=new TextEncoder,Tn=e=>new Uint8Array(e),$n=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),li=(e,t)=>e.slice(0,t),pi=(e,{contents:t,length:r},n)=>{let o=On()?di(t,n):fi(t,n);return new Uint8Array(o).set(e,r),o},fi=(e,t)=>{if(t<=e.byteLength)return e;let r=new ArrayBuffer(vn(t));return new Uint8Array(r).set(new Uint8Array(e),0),r},di=(e,t)=>{if(t<=e.maxByteLength)return e.resize(t),e;let r=new ArrayBuffer(t,{maxByteLength:vn(t)});return new Uint8Array(r).set(new Uint8Array(e),0),r},vn=e=>Pn**Math.ceil(Math.log(e)/Math.log(Pn)),Pn=2,mi=({contents:e,length:t})=>On()?e:e.slice(0,t),On=()=>"resize"in ArrayBuffer.prototype,hi={init:ai,convertChunk:{string:ci,buffer:Tn,arrayBuffer:Tn,dataView:$n,typedArray:$n,others:Be},getSize:De,truncateChunk:li,addChunk:pi,getFinalChunk:$t,finalize:mi};async function Me(e,t){if(!("Buffer"in globalThis))throw new Error("getStreamAsBuffer() is only supported in Node.js");try{return In(await vt(e,t))}catch(r){throw r.bufferedData!==void 0&&(r.bufferedData=In(r.bufferedData)),r}}var In=e=>globalThis.Buffer.from(e);async function Ot(e,t){return fe(e,Ei,t)}var yi=()=>({contents:"",textDecoder:new TextDecoder}),je=(e,{textDecoder:t})=>t.decode(e,{stream:!0}),gi=(e,{contents:t})=>t+e,bi=(e,t)=>e.slice(0,t),xi=({textDecoder:e})=>{let t=e.decode();return t===""?void 0:t},Ei={init:yi,convertChunk:{string:Tt,buffer:je,arrayBuffer:je,dataView:je,typedArray:je,others:Be},getSize:De,truncateChunk:bi,addChunk:gi,getFinalChunk:xi,finalize:Pt};var Nn=ze(Hn(),1),kn=e=>{if(e!==void 0)throw new TypeError("The `input` and `inputFile` options cannot be both set.")},_i=({input:e,inputFile:t})=>typeof t!="string"?e:(kn(e),wi(t)),Gn=e=>{let t=_i(e);if(ke(t))throw new TypeError("The `input` option cannot be a stream in sync mode");return t},Ci=({input:e,inputFile:t})=>typeof t!="string"?e:(kn(e),Ai(t)),Bn=(e,t)=>{let r=Ci(t);r!==void 0&&(ke(r)?r.pipe(e.stdin):e.stdin.end(r))},Dn=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=(0,Nn.default)();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},It=async(e,t)=>{if(!(!e||t===void 0)){await Ri(0),e.destroy();try{return await t}catch(r){return r.bufferedData}}},Lt=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(!(!e||!r))return t==="utf8"||t==="utf-8"?Ot(e,{maxBuffer:n}):t===null||t==="buffer"?Me(e,{maxBuffer:n}):Ti(e,n,t)},Ti=async(e,t,r)=>(await Me(e,{maxBuffer:t})).toString(r),Mn=async({stdout:e,stderr:t,all:r},{encoding:n,buffer:o,maxBuffer:s},i)=>{let l=Lt(e,{encoding:n,buffer:o,maxBuffer:s}),f=Lt(t,{encoding:n,buffer:o,maxBuffer:s}),h=Lt(r,{encoding:n,buffer:o,maxBuffer:s*2});try{return await Promise.all([i,l,f,h])}catch(m){return Promise.all([{error:m,signal:m.signal,timedOut:m.timedOut},It(e,l),It(t,f),It(r,h)])}};var $i=(async()=>{})().constructor.prototype,Pi=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor($i,e)]),Ht=(e,t)=>{for(let[r,n]of Pi){let o=typeof t=="function"?(...s)=>Reflect.apply(n.value,t(),s):n.value.bind(t);Reflect.defineProperty(e,r,{...n,value:o})}},jn=e=>new Promise((t,r)=>{e.on("exit",(n,o)=>{t({exitCode:n,signal:o})}),e.on("error",n=>{r(n)}),e.stdin&&e.stdin.on("error",n=>{r(n)})});import{Buffer as vi}from"node:buffer";import{ChildProcess as Oi}from"node:child_process";var qn=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],Ii=/^[\w.-]+$/,Li=e=>typeof e!="string"||Ii.test(e)?e:`"${e.replaceAll('"','\\"')}"`,Nt=(e,t)=>qn(e,t).join(" "),kt=(e,t)=>qn(e,t).map(r=>Li(r)).join(" "),Hi=/ +/g;var Fn=e=>{let t=typeof e;if(t==="string")return e;if(t==="number")return String(e);if(t==="object"&&e!==null&&!(e instanceof Oi)&&"stdout"in e){let r=typeof e.stdout;if(r==="string")return e.stdout;if(vi.isBuffer(e.stdout))return e.stdout.toString();throw new TypeError(`Unexpected "${r}" stdout in template expression`)}throw new TypeError(`Unexpected "${t}" in template expression`)},Un=(e,t,r)=>r||e.length===0||t.length===0?[...e,...t]:[...e.slice(0,-1),`${e.at(-1)}${t[0]}`,...t.slice(1)],Ni=({templates:e,expressions:t,tokens:r,index:n,template:o})=>{let s=o??e.raw[n],i=s.split(Hi).filter(Boolean),l=Un(r,i,s.startsWith(" "));if(n===t.length)return l;let f=t[n],h=Array.isArray(f)?f.map(m=>Fn(m)):[Fn(f)];return Un(l,h,s.endsWith(" "))},Gt=(e,t)=>{let r=[];for(let[n,o]of e.entries())r=Ni({templates:e,expressions:t,tokens:r,index:n,template:o});return r};import{debuglog as ki}from"node:util";import Gi from"node:process";var Kn=ki("execa").enabled,Fe=(e,t)=>String(e).padStart(t,"0"),Bi=()=>{let e=new Date;return`${Fe(e.getHours(),2)}:${Fe(e.getMinutes(),2)}:${Fe(e.getSeconds(),2)}.${Fe(e.getMilliseconds(),3)}`},Bt=(e,{verbose:t})=>{t&&Gi.stderr.write(`[${Bi()}] ${e}
`)};var ji=1e3*1e3*100,Fi=({env:e,extendEnv:t,preferLocal:r,localDir:n,execPath:o})=>{let s=t?{...Ue.env,...e}:e;return r?cn({env:s,cwd:n,execPath:o}):s},zn=(e,t,r={})=>{let n=Xn.default._parse(e,t,r);return e=n.command,t=n.args,r=n.options,r={maxBuffer:ji,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||Ue.cwd(),execPath:Ue.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,verbose:Kn,...r},r.env=Fi(r),r.stdio=yn(r),Ue.platform==="win32"&&Mi.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:n}},de=(e,t,r)=>typeof t!="string"&&!Di.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?yt(t):t;function me(e,t,r){let n=zn(e,t,r),o=Nt(e,t),s=kt(e,t);Bt(s,n.options),Sn(n.options);let i;try{i=Dt.spawn(n.file,n.args,n.options)}catch(R){let g=new Dt.ChildProcess,A=Promise.reject(pe({error:R,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return Ht(g,A),g}let l=jn(i),f=En(i,n.options,l),h=An(i,n.options,f),m={isCanceled:!1};i.kill=bn.bind(null,i.kill.bind(i)),i.cancel=xn.bind(null,i,m);let E=ln(async()=>{let[{error:R,exitCode:g,signal:A,timedOut:D},M,G,C]=await Mn(i,n.options,h),q=de(n.options,M),L=de(n.options,G),X=de(n.options,C);if(R||g!==0||A!==null){let N=pe({error:R,exitCode:g,signal:A,stdout:q,stderr:L,all:X,command:o,escapedCommand:s,parsed:n,timedOut:D,isCanceled:m.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return N;throw N}return{command:o,escapedCommand:s,exitCode:0,stdout:q,stderr:L,all:X,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return Bn(i,n.options),i.all=Dn(i,n.options),wn(i),Ht(i,E),i}function Ui(e,t,r){let n=zn(e,t,r),o=Nt(e,t),s=kt(e,t);Bt(s,n.options);let i=Gn(n.options),l;try{l=Dt.spawnSync(n.file,n.args,{...n.options,input:i})}catch(m){throw pe({error:m,stdout:"",stderr:"",all:"",command:o,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}let f=de(n.options,l.stdout,l.error),h=de(n.options,l.stderr,l.error);if(l.error||l.status!==0||l.signal!==null){let m=pe({stdout:f,stderr:h,error:l.error,signal:l.signal,exitCode:l.status,command:o,escapedCommand:s,parsed:n,timedOut:l.error&&l.error.code==="ETIMEDOUT",isCanceled:!1,killed:l.signal!==null});if(!n.options.reject)return m;throw m}return{command:o,escapedCommand:s,exitCode:0,stdout:f,stderr:h,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}var qi=({input:e,inputFile:t,stdio:r})=>e===void 0&&t===void 0&&r===void 0?{stdin:"inherit"}:{},Wn=(e={})=>({preferLocal:!0,...qi(e),...e});function Vn(e){function t(r,...n){if(!Array.isArray(r))return Vn({...e,...r});let[o,...s]=Gt(r,n);return me(o,s,Wn(e))}return t.sync=(r,...n)=>{if(!Array.isArray(r))throw new TypeError("Please use $(options).sync`command` instead of $.sync(options)`command`.");let[o,...s]=Gt(r,n);return Ui(o,s,Wn(e))},t}var fu=Vn();import Ki from"node:net";import Wi from"node:os";var qe=class extends Error{constructor(t){super(`${t} is locked`)}},se={old:new Set,young:new Set},Xi=1e3*15;var he,zi=()=>{let e=Wi.networkInterfaces(),t=new Set([void 0,"0.0.0.0"]);for(let r of Object.values(e))for(let n of r)t.add(n.address);return t},Qn=e=>new Promise((t,r)=>{let n=Ki.createServer();n.unref(),n.on("error",r),n.listen(e,()=>{let{port:o}=n.address();n.close(()=>{t(o)})})}),Yn=async(e,t)=>{if(e.host||e.port===0)return Qn(e);for(let r of t)try{await Qn({port:e.port,host:r})}catch(n){if(!["EADDRNOTAVAIL","EINVAL"].includes(n.code))throw n}return e.port},Vi=function*(e){e&&(yield*e),yield 0};async function Mt(e){let t,r=new Set;if(e&&(e.port&&(t=typeof e.port=="number"?[e.port]:e.port),e.exclude)){let o=e.exclude;if(typeof o[Symbol.iterator]!="function")throw new TypeError("The `exclude` option must be an iterable.");for(let s of o){if(typeof s!="number")throw new TypeError("Each item in the `exclude` option must be a number corresponding to the port you want excluded.");if(!Number.isSafeInteger(s))throw new TypeError(`Number ${s} in the exclude option is not a safe integer and can't be used`)}r=new Set(o)}he===void 0&&(he=setTimeout(()=>{he=void 0,se.old=se.young,se.young=new Set},Xi),he.unref&&he.unref());let n=zi();for(let o of Vi(t))try{if(r.has(o))continue;let s=await Yn({...e,port:o},n);for(;se.old.has(s)||se.young.has(s);){if(o!==0)throw new qe(o);s=await Yn({...e,port:o},n)}return se.young.add(s),s}catch(s){if(!["EADDRINUSE","EACCES"].includes(s.code)&&!(s instanceof qe))throw s}throw new Error("No available ports found")}var Ke=class e{static#n="127.0.0.1";#t;#e=-1;#r=null;constructor(t="php"){this.#t=Qi(t)}close(){return this.#r?.kill(),this.#r=null,Promise.resolve()}async listen(){return this.#r?this.#e:(this.#e=await Mt(),new Promise((t,r)=>{let n=["-S",`${e.#n}:${this.#e}`,"-t",Zi(new URL("../www",import.meta.url))];this.#r=me(this.#t,n),this.#r.on("error",r),setTimeout(()=>t(this.#e),1e3)}))}async transform(t){let r=await this.listen(),n=new URL(`http://${e.#n}:${r}/index.php`);n.searchParams.set("file",Yi(t));let o=await fetch(n);if(!o.ok)throw new Error(`An error occurred while processing the script: ${t}`);return o.text()}};import{normalize as Ji,resolve as ea}from"node:path";var We=class{#n;constructor(t="php"){this.#n=Ji(t)}close(){return Promise.resolve()}async transform(t){return(await me(this.#n,["-w",ea(t)])).stdout}};async function aa(){let{positionals:e,values:t}=ia({allowPositionals:!0,options:{binary:{short:"b",type:"string",default:!1},extension:{short:"e",type:"string",default:!1},help:{short:"h",type:"boolean",default:!1},mode:{short:"m",type:"string",default:!1},silent:{short:"s",type:"boolean",default:!1},version:{short:"v",type:"boolean",default:!1}}});if(t.help||t.version)return ye.log(t.version?yr.version:gr.trim()),0;if(!e.length)return ye.error("You must provide the path to the input directory."),1;let r=Zn(e[0]);try{await ta(r)}catch{return ye.error("The input directory was not found."),2}let n=e.length>1?Zn(e[1]):r;return await ca(r,n,t),0}async function ca(e,t,r={}){let n=r.binary??"php",o=r.extension??"php",s=r.mode??"safe",i=r.silent??!1,l=await eo.default.promise(e,{fileFilter:`*.${o}`}),f=s=="fast"?new Ke(n):new We(n),h=l.map(async m=>{i||ye.log(`Minifying: ${m.path}`);let x=await f.transform(m.fullPath),E=sa(t,m.path);return await ra(oa(E),{recursive:!0}),na(E,x)});for(let m of h)await m;return f.close()}aa().then(e=>Jn.exitCode=e,e=>{ye.error(e instanceof Error?e.message:e),Jn.exitCode=1});
