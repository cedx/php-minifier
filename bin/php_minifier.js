#!/usr/bin/env node
var Ps=Object.create;var Qt=Object.defineProperty;var $s=Object.getOwnPropertyDescriptor;var Os=Object.getOwnPropertyNames;var Is=Object.getPrototypeOf,Ls=Object.prototype.hasOwnProperty;var G=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var v=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ks=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Os(t))!Ls.call(e,s)&&s!==r&&Qt(e,s,{get:()=>t[s],enumerable:!(n=$s(t,s))||n.enumerable});return e};var de=(e,t,r)=>(r=e!=null?Ps(Is(e)):{},ks(t||!e||!e.__esModule?Qt(r,"default",{value:e,enumerable:!0}):r,e));var me=v((Qa,rr)=>{"use strict";var Ns=G("path"),Z="\\\\/",Zt=`[^${Z}]`,ee="\\.",Hs="\\+",Gs="\\?",Ie="\\/",Bs="(?=.)",Jt="[^/]",ot=`(?:${Ie}|$)`,er=`(?:^|${Ie})`,it=`${ee}{1,2}${ot}`,Ds=`(?!${ee})`,Ms=`(?!${er}${it})`,Fs=`(?!${ee}{0,1}${ot})`,Us=`(?!${it})`,qs=`[^.${Ie}]`,js=`${Jt}*?`,tr={DOT_LITERAL:ee,PLUS_LITERAL:Hs,QMARK_LITERAL:Gs,SLASH_LITERAL:Ie,ONE_CHAR:Bs,QMARK:Jt,END_ANCHOR:ot,DOTS_SLASH:it,NO_DOT:Ds,NO_DOTS:Ms,NO_DOT_SLASH:Fs,NO_DOTS_SLASH:Us,QMARK_NO_DOT:qs,STAR:js,START_ANCHOR:er},Ws={...tr,SLASH_LITERAL:`[${Z}]`,QMARK:Zt,STAR:`${Zt}*?`,DOTS_SLASH:`${ee}{1,2}(?:[${Z}]|$)`,NO_DOT:`(?!${ee})`,NO_DOTS:`(?!(?:^|[${Z}])${ee}{1,2}(?:[${Z}]|$))`,NO_DOT_SLASH:`(?!${ee}{0,1}(?:[${Z}]|$))`,NO_DOTS_SLASH:`(?!${ee}{1,2}(?:[${Z}]|$))`,QMARK_NO_DOT:`[^.${Z}]`,START_ANCHOR:`(?:^|[${Z}])`,END_ANCHOR:`(?:[${Z}]|$)`},Ks={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};rr.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ks,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:Ns.sep,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Ws:tr}}});var Le=v(W=>{"use strict";var Xs=G("path"),zs=process.platform==="win32",{REGEX_BACKSLASH:Vs,REGEX_REMOVE_BACKSLASH:Ys,REGEX_SPECIAL_CHARS:Qs,REGEX_SPECIAL_CHARS_GLOBAL:Zs}=me();W.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);W.hasRegexChars=e=>Qs.test(e);W.isRegexChar=e=>e.length===1&&W.hasRegexChars(e);W.escapeRegex=e=>e.replace(Zs,"\\$1");W.toPosixSlashes=e=>e.replace(Vs,"/");W.removeBackslashes=e=>e.replace(Ys,t=>t==="\\"?"":t);W.supportsLookbehinds=()=>{let e=process.version.slice(1).split(".").map(Number);return e.length===3&&e[0]>=9||e[0]===8&&e[1]>=10};W.isWindows=e=>e&&typeof e.windows=="boolean"?e.windows:zs===!0||Xs.sep==="\\";W.escapeLast=(e,t,r)=>{let n=e.lastIndexOf(t,r);return n===-1?e:e[n-1]==="\\"?W.escapeLast(e,t,n-1):`${e.slice(0,n)}\\${e.slice(n)}`};W.removePrefix=(e,t={})=>{let r=e;return r.startsWith("./")&&(r=r.slice(2),t.prefix="./"),r};W.wrapOutput=(e,t={},r={})=>{let n=r.contains?"":"^",s=r.contains?"":"$",o=`${n}(?:${e})${s}`;return t.negated===!0&&(o=`(?:^(?!${o}).*$)`),o}});var lr=v((Ja,ur)=>{"use strict";var nr=Le(),{CHAR_ASTERISK:at,CHAR_AT:Js,CHAR_BACKWARD_SLASH:he,CHAR_COMMA:eo,CHAR_DOT:ct,CHAR_EXCLAMATION_MARK:ut,CHAR_FORWARD_SLASH:cr,CHAR_LEFT_CURLY_BRACE:lt,CHAR_LEFT_PARENTHESES:ft,CHAR_LEFT_SQUARE_BRACKET:to,CHAR_PLUS:ro,CHAR_QUESTION_MARK:sr,CHAR_RIGHT_CURLY_BRACE:no,CHAR_RIGHT_PARENTHESES:or,CHAR_RIGHT_SQUARE_BRACKET:so}=me(),ir=e=>e===cr||e===he,ar=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?1/0:1)},oo=(e,t)=>{let r=t||{},n=e.length-1,s=r.parts===!0||r.scanToEnd===!0,o=[],i=[],l=[],p=e,h=-1,m=0,x=0,E=!1,R=!1,y=!1,w=!1,F=!1,U=!1,M=!1,C=!1,K=!1,N=!1,V=0,B,g,_={value:"",depth:0,isGlob:!1},D=()=>h>=n,u=()=>p.charCodeAt(h+1),I=()=>(B=g,p.charCodeAt(++h));for(;h<n;){g=I();let q;if(g===he){M=_.backslashes=!0,g=I(),g===lt&&(U=!0);continue}if(U===!0||g===lt){for(V++;D()!==!0&&(g=I());){if(g===he){M=_.backslashes=!0,I();continue}if(g===lt){V++;continue}if(U!==!0&&g===ct&&(g=I())===ct){if(E=_.isBrace=!0,y=_.isGlob=!0,N=!0,s===!0)continue;break}if(U!==!0&&g===eo){if(E=_.isBrace=!0,y=_.isGlob=!0,N=!0,s===!0)continue;break}if(g===no&&(V--,V===0)){U=!1,E=_.isBrace=!0,N=!0;break}}if(s===!0)continue;break}if(g===cr){if(o.push(h),i.push(_),_={value:"",depth:0,isGlob:!1},N===!0)continue;if(B===ct&&h===m+1){m+=2;continue}x=h+1;continue}if(r.noext!==!0&&(g===ro||g===Js||g===at||g===sr||g===ut)===!0&&u()===ft){if(y=_.isGlob=!0,w=_.isExtglob=!0,N=!0,g===ut&&h===m&&(K=!0),s===!0){for(;D()!==!0&&(g=I());){if(g===he){M=_.backslashes=!0,g=I();continue}if(g===or){y=_.isGlob=!0,N=!0;break}}continue}break}if(g===at){if(B===at&&(F=_.isGlobstar=!0),y=_.isGlob=!0,N=!0,s===!0)continue;break}if(g===sr){if(y=_.isGlob=!0,N=!0,s===!0)continue;break}if(g===to){for(;D()!==!0&&(q=I());){if(q===he){M=_.backslashes=!0,I();continue}if(q===so){R=_.isBracket=!0,y=_.isGlob=!0,N=!0;break}}if(s===!0)continue;break}if(r.nonegate!==!0&&g===ut&&h===m){C=_.negated=!0,m++;continue}if(r.noparen!==!0&&g===ft){if(y=_.isGlob=!0,s===!0){for(;D()!==!0&&(g=I());){if(g===ft){M=_.backslashes=!0,g=I();continue}if(g===or){N=!0;break}}continue}break}if(y===!0){if(N=!0,s===!0)continue;break}}r.noext===!0&&(w=!1,y=!1);let $=p,te="",a="";m>0&&(te=p.slice(0,m),p=p.slice(m),x-=m),$&&y===!0&&x>0?($=p.slice(0,x),a=p.slice(x)):y===!0?($="",a=p):$=p,$&&$!==""&&$!=="/"&&$!==p&&ir($.charCodeAt($.length-1))&&($=$.slice(0,-1)),r.unescape===!0&&(a&&(a=nr.removeBackslashes(a)),$&&M===!0&&($=nr.removeBackslashes($)));let c={prefix:te,input:e,start:m,base:$,glob:a,isBrace:E,isBracket:R,isGlob:y,isExtglob:w,isGlobstar:F,negated:C,negatedExtglob:K};if(r.tokens===!0&&(c.maxDepth=0,ir(g)||i.push(_),c.tokens=i),r.parts===!0||r.tokens===!0){let q;for(let A=0;A<o.length;A++){let Y=q?q+1:m,Q=o[A],X=e.slice(Y,Q);r.tokens&&(A===0&&m!==0?(i[A].isPrefix=!0,i[A].value=te):i[A].value=X,ar(i[A]),c.maxDepth+=i[A].depth),(A!==0||X!=="")&&l.push(X),q=Q}if(q&&q+1<e.length){let A=e.slice(q+1);l.push(A),r.tokens&&(i[i.length-1].value=A,ar(i[i.length-1]),c.maxDepth+=i[i.length-1].depth)}c.slashes=o,c.parts=l}return c};ur.exports=oo});var dr=v((ec,pr)=>{"use strict";var ke=me(),z=Le(),{MAX_LENGTH:Ne,POSIX_REGEX_SOURCE:io,REGEX_NON_SPECIAL_CHARS:ao,REGEX_SPECIAL_CHARS_BACKREF:co,REPLACEMENTS:fr}=ke,uo=(e,t)=>{if(typeof t.expandRange=="function")return t.expandRange(...e,t);e.sort();let r=`[${e.join("-")}]`;try{new RegExp(r)}catch{return e.map(s=>z.escapeRegex(s)).join("..")}return r},oe=(e,t)=>`Missing ${e}: "${t}" - use "\\\\${t}" to match literal characters`,pt=(e,t)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=fr[e]||e;let r={...t},n=typeof r.maxLength=="number"?Math.min(Ne,r.maxLength):Ne,s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);let o={type:"bos",value:"",output:r.prepend||""},i=[o],l=r.capture?"":"?:",p=z.isWindows(t),h=ke.globChars(p),m=ke.extglobChars(h),{DOT_LITERAL:x,PLUS_LITERAL:E,SLASH_LITERAL:R,ONE_CHAR:y,DOTS_SLASH:w,NO_DOT:F,NO_DOT_SLASH:U,NO_DOTS_SLASH:M,QMARK:C,QMARK_NO_DOT:K,STAR:N,START_ANCHOR:V}=h,B=d=>`(${l}(?:(?!${V}${d.dot?w:x}).)*?)`,g=r.dot?"":F,_=r.dot?C:K,D=r.bash===!0?B(r):N;r.capture&&(D=`(${D})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let u={input:e,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:i};e=z.removePrefix(e,u),s=e.length;let I=[],$=[],te=[],a=o,c,q=()=>u.index===s-1,A=u.peek=(d=1)=>e[u.index+d],Y=u.advance=()=>e[++u.index]||"",Q=()=>e.slice(u.index+1),X=(d="",O=0)=>{u.consumed+=d,u.index+=O},ve=d=>{u.output+=d.output!=null?d.output:d.value,X(d.value)},Ts=()=>{let d=1;for(;A()==="!"&&(A(2)!=="("||A(3)==="?");)Y(),u.start++,d++;return d%2===0?!1:(u.negated=!0,u.start++,!0)},Pe=d=>{u[d]++,te.push(d)},re=d=>{u[d]--,te.pop()},S=d=>{if(a.type==="globstar"){let O=u.braces>0&&(d.type==="comma"||d.type==="brace"),f=d.extglob===!0||I.length&&(d.type==="pipe"||d.type==="paren");d.type!=="slash"&&d.type!=="paren"&&!O&&!f&&(u.output=u.output.slice(0,-a.output.length),a.type="star",a.value="*",a.output=D,u.output+=a.output)}if(I.length&&d.type!=="paren"&&(I[I.length-1].inner+=d.value),(d.value||d.output)&&ve(d),a&&a.type==="text"&&d.type==="text"){a.value+=d.value,a.output=(a.output||"")+d.value;return}d.prev=a,i.push(d),a=d},$e=(d,O)=>{let f={...m[O],conditions:1,inner:""};f.prev=a,f.parens=u.parens,f.output=u.output;let b=(r.capture?"(":"")+f.open;Pe("parens"),S({type:d,value:O,output:u.output?"":y}),S({type:"paren",extglob:!0,value:Y(),output:b}),I.push(f)},vs=d=>{let O=d.close+(r.capture?")":""),f;if(d.type==="negate"){let b=D;if(d.inner&&d.inner.length>1&&d.inner.includes("/")&&(b=B(r)),(b!==D||q()||/^\)+$/.test(Q()))&&(O=d.close=`)$))${b}`),d.inner.includes("*")&&(f=Q())&&/^\.[^\\/.]+$/.test(f)){let L=pt(f,{...t,fastpaths:!1}).output;O=d.close=`)${L})${b})`}d.prev.type==="bos"&&(u.negatedExtglob=!0)}S({type:"paren",extglob:!0,value:c,output:O}),re("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let d=!1,O=e.replace(co,(f,b,L,j,H,st)=>j==="\\"?(d=!0,f):j==="?"?b?b+j+(H?C.repeat(H.length):""):st===0?_+(H?C.repeat(H.length):""):C.repeat(L.length):j==="."?x.repeat(L.length):j==="*"?b?b+j+(H?D:""):D:b?f:`\\${f}`);return d===!0&&(r.unescape===!0?O=O.replace(/\\/g,""):O=O.replace(/\\+/g,f=>f.length%2===0?"\\\\":f?"\\":"")),O===e&&r.contains===!0?(u.output=e,u):(u.output=z.wrapOutput(O,u,t),u)}for(;!q();){if(c=Y(),c==="\0")continue;if(c==="\\"){let f=A();if(f==="/"&&r.bash!==!0||f==="."||f===";")continue;if(!f){c+="\\",S({type:"text",value:c});continue}let b=/^\\+/.exec(Q()),L=0;if(b&&b[0].length>2&&(L=b[0].length,u.index+=L,L%2!==0&&(c+="\\")),r.unescape===!0?c=Y():c+=Y(),u.brackets===0){S({type:"text",value:c});continue}}if(u.brackets>0&&(c!=="]"||a.value==="["||a.value==="[^")){if(r.posix!==!1&&c===":"){let f=a.value.slice(1);if(f.includes("[")&&(a.posix=!0,f.includes(":"))){let b=a.value.lastIndexOf("["),L=a.value.slice(0,b),j=a.value.slice(b+2),H=io[j];if(H){a.value=L+H,u.backtrack=!0,Y(),!o.output&&i.indexOf(a)===1&&(o.output=y);continue}}}(c==="["&&A()!==":"||c==="-"&&A()==="]")&&(c=`\\${c}`),c==="]"&&(a.value==="["||a.value==="[^")&&(c=`\\${c}`),r.posix===!0&&c==="!"&&a.value==="["&&(c="^"),a.value+=c,ve({value:c});continue}if(u.quotes===1&&c!=='"'){c=z.escapeRegex(c),a.value+=c,ve({value:c});continue}if(c==='"'){u.quotes=u.quotes===1?0:1,r.keepQuotes===!0&&S({type:"text",value:c});continue}if(c==="("){Pe("parens"),S({type:"paren",value:c});continue}if(c===")"){if(u.parens===0&&r.strictBrackets===!0)throw new SyntaxError(oe("opening","("));let f=I[I.length-1];if(f&&u.parens===f.parens+1){vs(I.pop());continue}S({type:"paren",value:c,output:u.parens?")":"\\)"}),re("parens");continue}if(c==="["){if(r.nobracket===!0||!Q().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(oe("closing","]"));c=`\\${c}`}else Pe("brackets");S({type:"bracket",value:c});continue}if(c==="]"){if(r.nobracket===!0||a&&a.type==="bracket"&&a.value.length===1){S({type:"text",value:c,output:`\\${c}`});continue}if(u.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(oe("opening","["));S({type:"text",value:c,output:`\\${c}`});continue}re("brackets");let f=a.value.slice(1);if(a.posix!==!0&&f[0]==="^"&&!f.includes("/")&&(c=`/${c}`),a.value+=c,ve({value:c}),r.literalBrackets===!1||z.hasRegexChars(f))continue;let b=z.escapeRegex(a.value);if(u.output=u.output.slice(0,-a.value.length),r.literalBrackets===!0){u.output+=b,a.value=b;continue}a.value=`(${l}${b}|${a.value})`,u.output+=a.value;continue}if(c==="{"&&r.nobrace!==!0){Pe("braces");let f={type:"brace",value:c,output:"(",outputIndex:u.output.length,tokensIndex:u.tokens.length};$.push(f),S(f);continue}if(c==="}"){let f=$[$.length-1];if(r.nobrace===!0||!f){S({type:"text",value:c,output:c});continue}let b=")";if(f.dots===!0){let L=i.slice(),j=[];for(let H=L.length-1;H>=0&&(i.pop(),L[H].type!=="brace");H--)L[H].type!=="dots"&&j.unshift(L[H].value);b=uo(j,r),u.backtrack=!0}if(f.comma!==!0&&f.dots!==!0){let L=u.output.slice(0,f.outputIndex),j=u.tokens.slice(f.tokensIndex);f.value=f.output="\\{",c=b="\\}",u.output=L;for(let H of j)u.output+=H.output||H.value}S({type:"brace",value:c,output:b}),re("braces"),$.pop();continue}if(c==="|"){I.length>0&&I[I.length-1].conditions++,S({type:"text",value:c});continue}if(c===","){let f=c,b=$[$.length-1];b&&te[te.length-1]==="braces"&&(b.comma=!0,f="|"),S({type:"comma",value:c,output:f});continue}if(c==="/"){if(a.type==="dot"&&u.index===u.start+1){u.start=u.index+1,u.consumed="",u.output="",i.pop(),a=o;continue}S({type:"slash",value:c,output:R});continue}if(c==="."){if(u.braces>0&&a.type==="dot"){a.value==="."&&(a.output=x);let f=$[$.length-1];a.type="dots",a.output+=c,a.value+=c,f.dots=!0;continue}if(u.braces+u.parens===0&&a.type!=="bos"&&a.type!=="slash"){S({type:"text",value:c,output:x});continue}S({type:"dot",value:c,output:x});continue}if(c==="?"){if(!(a&&a.value==="(")&&r.noextglob!==!0&&A()==="("&&A(2)!=="?"){$e("qmark",c);continue}if(a&&a.type==="paren"){let b=A(),L=c;if(b==="<"&&!z.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(a.value==="("&&!/[!=<:]/.test(b)||b==="<"&&!/<([!=]|\w+>)/.test(Q()))&&(L=`\\${c}`),S({type:"text",value:c,output:L});continue}if(r.dot!==!0&&(a.type==="slash"||a.type==="bos")){S({type:"qmark",value:c,output:K});continue}S({type:"qmark",value:c,output:C});continue}if(c==="!"){if(r.noextglob!==!0&&A()==="("&&(A(2)!=="?"||!/[!=<:]/.test(A(3)))){$e("negate",c);continue}if(r.nonegate!==!0&&u.index===0){Ts();continue}}if(c==="+"){if(r.noextglob!==!0&&A()==="("&&A(2)!=="?"){$e("plus",c);continue}if(a&&a.value==="("||r.regex===!1){S({type:"plus",value:c,output:E});continue}if(a&&(a.type==="bracket"||a.type==="paren"||a.type==="brace")||u.parens>0){S({type:"plus",value:c});continue}S({type:"plus",value:E});continue}if(c==="@"){if(r.noextglob!==!0&&A()==="("&&A(2)!=="?"){S({type:"at",extglob:!0,value:c,output:""});continue}S({type:"text",value:c});continue}if(c!=="*"){(c==="$"||c==="^")&&(c=`\\${c}`);let f=ao.exec(Q());f&&(c+=f[0],u.index+=f[0].length),S({type:"text",value:c});continue}if(a&&(a.type==="globstar"||a.star===!0)){a.type="star",a.star=!0,a.value+=c,a.output=D,u.backtrack=!0,u.globstar=!0,X(c);continue}let d=Q();if(r.noextglob!==!0&&/^\([^?]/.test(d)){$e("star",c);continue}if(a.type==="star"){if(r.noglobstar===!0){X(c);continue}let f=a.prev,b=f.prev,L=f.type==="slash"||f.type==="bos",j=b&&(b.type==="star"||b.type==="globstar");if(r.bash===!0&&(!L||d[0]&&d[0]!=="/")){S({type:"star",value:c,output:""});continue}let H=u.braces>0&&(f.type==="comma"||f.type==="brace"),st=I.length&&(f.type==="pipe"||f.type==="paren");if(!L&&f.type!=="paren"&&!H&&!st){S({type:"star",value:c,output:""});continue}for(;d.slice(0,3)==="/**";){let Oe=e[u.index+4];if(Oe&&Oe!=="/")break;d=d.slice(3),X("/**",3)}if(f.type==="bos"&&q()){a.type="globstar",a.value+=c,a.output=B(r),u.output=a.output,u.globstar=!0,X(c);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&!j&&q()){u.output=u.output.slice(0,-(f.output+a.output).length),f.output=`(?:${f.output}`,a.type="globstar",a.output=B(r)+(r.strictSlashes?")":"|$)"),a.value+=c,u.globstar=!0,u.output+=f.output+a.output,X(c);continue}if(f.type==="slash"&&f.prev.type!=="bos"&&d[0]==="/"){let Oe=d[1]!==void 0?"|$":"";u.output=u.output.slice(0,-(f.output+a.output).length),f.output=`(?:${f.output}`,a.type="globstar",a.output=`${B(r)}${R}|${R}${Oe})`,a.value+=c,u.output+=f.output+a.output,u.globstar=!0,X(c+Y()),S({type:"slash",value:"/",output:""});continue}if(f.type==="bos"&&d[0]==="/"){a.type="globstar",a.value+=c,a.output=`(?:^|${R}|${B(r)}${R})`,u.output=a.output,u.globstar=!0,X(c+Y()),S({type:"slash",value:"/",output:""});continue}u.output=u.output.slice(0,-a.output.length),a.type="globstar",a.output=B(r),a.value+=c,u.output+=a.output,u.globstar=!0,X(c);continue}let O={type:"star",value:c,output:D};if(r.bash===!0){O.output=".*?",(a.type==="bos"||a.type==="slash")&&(O.output=g+O.output),S(O);continue}if(a&&(a.type==="bracket"||a.type==="paren")&&r.regex===!0){O.output=c,S(O);continue}(u.index===u.start||a.type==="slash"||a.type==="dot")&&(a.type==="dot"?(u.output+=U,a.output+=U):r.dot===!0?(u.output+=M,a.output+=M):(u.output+=g,a.output+=g),A()!=="*"&&(u.output+=y,a.output+=y)),S(O)}for(;u.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(oe("closing","]"));u.output=z.escapeLast(u.output,"["),re("brackets")}for(;u.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(oe("closing",")"));u.output=z.escapeLast(u.output,"("),re("parens")}for(;u.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(oe("closing","}"));u.output=z.escapeLast(u.output,"{"),re("braces")}if(r.strictSlashes!==!0&&(a.type==="star"||a.type==="bracket")&&S({type:"maybe_slash",value:"",output:`${R}?`}),u.backtrack===!0){u.output="";for(let d of u.tokens)u.output+=d.output!=null?d.output:d.value,d.suffix&&(u.output+=d.suffix)}return u};pt.fastpaths=(e,t)=>{let r={...t},n=typeof r.maxLength=="number"?Math.min(Ne,r.maxLength):Ne,s=e.length;if(s>n)throw new SyntaxError(`Input length: ${s}, exceeds maximum allowed length: ${n}`);e=fr[e]||e;let o=z.isWindows(t),{DOT_LITERAL:i,SLASH_LITERAL:l,ONE_CHAR:p,DOTS_SLASH:h,NO_DOT:m,NO_DOTS:x,NO_DOTS_SLASH:E,STAR:R,START_ANCHOR:y}=ke.globChars(o),w=r.dot?x:m,F=r.dot?E:m,U=r.capture?"":"?:",M={negated:!1,prefix:""},C=r.bash===!0?".*?":R;r.capture&&(C=`(${C})`);let K=g=>g.noglobstar===!0?C:`(${U}(?:(?!${y}${g.dot?h:i}).)*?)`,N=g=>{switch(g){case"*":return`${w}${p}${C}`;case".*":return`${i}${p}${C}`;case"*.*":return`${w}${C}${i}${p}${C}`;case"*/*":return`${w}${C}${l}${p}${F}${C}`;case"**":return w+K(r);case"**/*":return`(?:${w}${K(r)}${l})?${F}${p}${C}`;case"**/*.*":return`(?:${w}${K(r)}${l})?${F}${C}${i}${p}${C}`;case"**/.*":return`(?:${w}${K(r)}${l})?${i}${p}${C}`;default:{let _=/^(.*?)\.(\w+)$/.exec(g);if(!_)return;let D=N(_[1]);return D?D+i+_[2]:void 0}}},V=z.removePrefix(e,M),B=N(V);return B&&r.strictSlashes!==!0&&(B+=`${l}?`),B};pr.exports=pt});var hr=v((tc,mr)=>{"use strict";var lo=G("path"),fo=lr(),dt=dr(),mt=Le(),po=me(),mo=e=>e&&typeof e=="object"&&!Array.isArray(e),k=(e,t,r=!1)=>{if(Array.isArray(e)){let m=e.map(E=>k(E,t,r));return E=>{for(let R of m){let y=R(E);if(y)return y}return!1}}let n=mo(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let s=t||{},o=mt.isWindows(t),i=n?k.compileRe(e,t):k.makeRe(e,t,!1,!0),l=i.state;delete i.state;let p=()=>!1;if(s.ignore){let m={...t,ignore:null,onMatch:null,onResult:null};p=k(s.ignore,m,r)}let h=(m,x=!1)=>{let{isMatch:E,match:R,output:y}=k.test(m,i,t,{glob:e,posix:o}),w={glob:e,state:l,regex:i,posix:o,input:m,output:y,match:R,isMatch:E};return typeof s.onResult=="function"&&s.onResult(w),E===!1?(w.isMatch=!1,x?w:!1):p(m)?(typeof s.onIgnore=="function"&&s.onIgnore(w),w.isMatch=!1,x?w:!1):(typeof s.onMatch=="function"&&s.onMatch(w),x?w:!0)};return r&&(h.state=l),h};k.test=(e,t,r,{glob:n,posix:s}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let o=r||{},i=o.format||(s?mt.toPosixSlashes:null),l=e===n,p=l&&i?i(e):e;return l===!1&&(p=i?i(e):e,l=p===n),(l===!1||o.capture===!0)&&(o.matchBase===!0||o.basename===!0?l=k.matchBase(e,t,r,s):l=t.exec(p)),{isMatch:!!l,match:l,output:p}};k.matchBase=(e,t,r,n=mt.isWindows(r))=>(t instanceof RegExp?t:k.makeRe(t,r)).test(lo.basename(e));k.isMatch=(e,t,r)=>k(t,r)(e);k.parse=(e,t)=>Array.isArray(e)?e.map(r=>k.parse(r,t)):dt(e,{...t,fastpaths:!1});k.scan=(e,t)=>fo(e,t);k.compileRe=(e,t,r=!1,n=!1)=>{if(r===!0)return e.output;let s=t||{},o=s.contains?"":"^",i=s.contains?"":"$",l=`${o}(?:${e.output})${i}`;e&&e.negated===!0&&(l=`^(?!${l}).*$`);let p=k.toRegex(l,t);return n===!0&&(p.state=e),p};k.makeRe=(e,t={},r=!1,n=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let s={negated:!1,fastpaths:!0};return t.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(s.output=dt.fastpaths(e,t)),s.output||(s=dt(e,t)),k.compileRe(s,t,r,n)};k.toRegex=(e,t)=>{try{let r=t||{};return new RegExp(e,r.flags||(r.nocase?"i":""))}catch(r){if(t&&t.debug===!0)throw r;return/$^/}};k.constants=po;mr.exports=k});var yr=v((rc,gr)=>{"use strict";gr.exports=hr()});var _r=v((nc,Rr)=>{"use strict";var ye=G("fs"),{Readable:ho}=G("stream"),ge=G("path"),{promisify:De}=G("util"),ht=yr(),go=De(ye.readdir),yo=De(ye.stat),br=De(ye.lstat),bo=De(ye.realpath),xo="!",wr="READDIRP_RECURSIVE_ERROR",Eo=new Set(["ENOENT","EPERM","EACCES","ELOOP",wr]),gt="files",Ar="directories",Ge="files_directories",He="all",xr=[gt,Ar,Ge,He],So=e=>Eo.has(e.code),[Er,wo]=process.versions.node.split(".").slice(0,2).map(e=>Number.parseInt(e,10)),Ao=process.platform==="win32"&&(Er>10||Er===10&&wo>=5),Sr=e=>{if(e!==void 0){if(typeof e=="function")return e;if(typeof e=="string"){let t=ht(e.trim());return r=>t(r.basename)}if(Array.isArray(e)){let t=[],r=[];for(let n of e){let s=n.trim();s.charAt(0)===xo?r.push(ht(s.slice(1))):t.push(ht(s))}return r.length>0?t.length>0?n=>t.some(s=>s(n.basename))&&!r.some(s=>s(n.basename)):n=>!r.some(s=>s(n.basename)):n=>t.some(s=>s(n.basename))}}},Be=class e extends ho{static get defaultOptions(){return{root:".",fileFilter:t=>!0,directoryFilter:t=>!0,type:gt,lstat:!1,depth:2147483648,alwaysStat:!1}}constructor(t={}){super({objectMode:!0,autoDestroy:!0,highWaterMark:t.highWaterMark||4096});let r={...e.defaultOptions,...t},{root:n,type:s}=r;this._fileFilter=Sr(r.fileFilter),this._directoryFilter=Sr(r.directoryFilter);let o=r.lstat?br:yo;Ao?this._stat=i=>o(i,{bigint:!0}):this._stat=o,this._maxDepth=r.depth,this._wantsDir=[Ar,Ge,He].includes(s),this._wantsFile=[gt,Ge,He].includes(s),this._wantsEverything=s===He,this._root=ge.resolve(n),this._isDirent="Dirent"in ye&&!r.alwaysStat,this._statsProp=this._isDirent?"dirent":"stats",this._rdOptions={encoding:"utf8",withFileTypes:this._isDirent},this.parents=[this._exploreDir(n,1)],this.reading=!1,this.parent=void 0}async _read(t){if(!this.reading){this.reading=!0;try{for(;!this.destroyed&&t>0;){let{path:r,depth:n,files:s=[]}=this.parent||{};if(s.length>0){let o=s.splice(0,t).map(i=>this._formatEntry(i,r));for(let i of await Promise.all(o)){if(this.destroyed)return;let l=await this._getEntryType(i);l==="directory"&&this._directoryFilter(i)?(n<=this._maxDepth&&this.parents.push(this._exploreDir(i.fullPath,n+1)),this._wantsDir&&(this.push(i),t--)):(l==="file"||this._includeAsFile(i))&&this._fileFilter(i)&&this._wantsFile&&(this.push(i),t--)}}else{let o=this.parents.pop();if(!o){this.push(null);break}if(this.parent=await o,this.destroyed)return}}}catch(r){this.destroy(r)}finally{this.reading=!1}}}async _exploreDir(t,r){let n;try{n=await go(t,this._rdOptions)}catch(s){this._onError(s)}return{files:n,depth:r,path:t}}async _formatEntry(t,r){let n;try{let s=this._isDirent?t.name:t,o=ge.resolve(ge.join(r,s));n={path:ge.relative(this._root,o),fullPath:o,basename:s},n[this._statsProp]=this._isDirent?t:await this._stat(o)}catch(s){this._onError(s)}return n}_onError(t){So(t)&&!this.destroyed?this.emit("warn",t):this.destroy(t)}async _getEntryType(t){let r=t&&t[this._statsProp];if(r){if(r.isFile())return"file";if(r.isDirectory())return"directory";if(r&&r.isSymbolicLink()){let n=t.fullPath;try{let s=await bo(n),o=await br(s);if(o.isFile())return"file";if(o.isDirectory()){let i=s.length;if(n.startsWith(s)&&n.substr(i,1)===ge.sep){let l=new Error(`Circular symlink detected: "${n}" points to "${s}"`);return l.code=wr,this._onError(l)}return"directory"}}catch(s){this._onError(s)}}}}_includeAsFile(t){let r=t&&t[this._statsProp];return r&&this._wantsEverything&&!r.isDirectory()}},ie=(e,t={})=>{let r=t.entryType||t.type;if(r==="both"&&(r=Ge),r&&(t.type=r),e){if(typeof e!="string")throw new TypeError("readdirp: root argument must be a string. Usage: readdirp(root, options)");if(r&&!xr.includes(r))throw new Error(`readdirp: Invalid type passed. Use one of ${xr.join(", ")}`)}else throw new Error("readdirp: root argument is required. Usage: readdirp(root, options)");return t.root=e,new Be(t)},Ro=(e,t={})=>new Promise((r,n)=>{let s=[];ie(e,t).on("data",o=>s.push(o)).on("end",()=>r(s)).on("error",o=>n(o))});ie.promise=Ro;ie.ReaddirpStream=Be;ie.default=ie;Rr.exports=ie});var $r=v((ic,Pr)=>{Pr.exports=vr({alwaysReturn:!0},vr);function ae(e,t){return e.level=0,e.hasBasic=!1,e.has256=!1,e.has16m=!1,t.alwaysReturn?e:!1}function Me(e){return e.hasBasic=!0,e.has256=!1,e.has16m=!1,e.level=1,e}function ce(e){return e.hasBasic=!0,e.has256=!0,e.has16m=!1,e.level=2,e}function Fe(e){return e.hasBasic=!0,e.has256=!0,e.has16m=!0,e.level=3,e}function vr(e,t){if(e=e||{},t=t||{},typeof e.level=="number")switch(e.level){case 0:return ae(t,e);case 1:return Me(t);case 2:return ce(t);case 3:return Fe(t)}if(t.level=0,t.hasBasic=!1,t.has256=!1,t.has16m=!1,typeof process>"u"||!process||!process.stdout||!process.env||!process.platform)return ae(t,e);var r=e.env||process.env,n=e.stream||process.stdout,s=e.term||r.TERM||"",o=e.platform||process.platform;if(!e.ignoreTTY&&!n.isTTY||!e.ignoreDumb&&s==="dumb"&&!r.COLORTERM)return ae(t,e);if(o==="win32")return Me(t);if(r.TMUX)return ce(t);if(!e.ignoreCI&&(r.CI||r.TEAMCITY_VERSION))return r.TRAVIS?ce(t):ae(t,e);switch(r.TERM_PROGRAM){case"iTerm.app":var i=r.TERM_PROGRAM_VERSION||"0.";return/^[0-2]\./.test(i)?ce(t):Fe(t);case"HyperTerm":case"Hyper":return Fe(t);case"MacTerm":return Fe(t);case"Apple_Terminal":return ce(t)}return/^xterm-256/.test(s)?ce(t):/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(s)||r.COLORTERM?Me(t):ae(t,e)}});var kr=v((ac,ue)=>{"use strict";var Ir=G("util"),Co=G("console").Console,To=$r(),J=new Co({stdout:process.stdout,stderr:process.stderr,colorMode:!1});function Or(e){return process.argv.indexOf("--"+e)!==-1}function vo(){return Or("no-color")?!1:!!(Or("color")||To())}function Lr(){this.now=new Date}Lr.prototype[Ir.inspect.custom]=function(e,t){var r=this.now.toLocaleTimeString("en",{hour12:!1});return"["+t.stylize(r,"date")+"]"};function be(){return Ir.inspect(new Lr,{colors:vo()})}function Po(){var e=be();return process.stdout.write(e+" "),J.log.apply(J,arguments),this}function $o(){var e=be();return process.stdout.write(e+" "),J.info.apply(J,arguments),this}function Oo(){var e=be();return process.stdout.write(e+" "),J.dir.apply(J,arguments),this}function Io(){var e=be();return process.stderr.write(e+" "),J.warn.apply(J,arguments),this}function Lo(){var e=be();return process.stderr.write(e+" "),J.error.apply(J,arguments),this}ue.exports=Po;ue.exports.info=$o;ue.exports.dir=Oo;ue.exports.warn=Io;ue.exports.error=Lo});var Hr=v((cc,Nr)=>{"use strict";Nr.exports=function(e,t,r){return"\x1B["+e+"m"+r+"\x1B["+t+"m"}});var Gr=v(T=>{"use strict";var P=Hr();T.bgblack=function(t){return P(40,49,t)};T.bgblue=function(t){return P(44,49,t)};T.bgcyan=function(t){return P(46,49,t)};T.bggreen=function(t){return P(42,49,t)};T.bgmagenta=function(t){return P(45,49,t)};T.bgred=function(t){return P(41,49,t)};T.bgwhite=function(t){return P(47,49,t)};T.bgyellow=function(t){return P(43,49,t)};T.black=function(t){return P(30,39,t)};T.blue=function(t){return P(34,39,t)};T.bold=function(t){return P(1,22,t)};T.cyan=function(t){return P(36,39,t)};T.dim=function(t){return P(2,22,t)};T.gray=function(t){return P(90,39,t)};T.green=function(t){return P(32,39,t)};T.grey=function(t){return P(90,39,t)};T.hidden=function(t){return P(8,28,t)};T.inverse=function(t){return P(7,27,t)};T.italic=function(t){return P(3,23,t)};T.magenta=function(t){return P(35,39,t)};T.red=function(t){return P(31,39,t)};T.reset=function(t){return P(0,0,t)};T.strikethrough=function(t){return P(9,29,t)};T.underline=function(t){return P(4,24,t)};T.white=function(t){return P(37,39,t)};T.yellow=function(t){return P(33,39,t)}});var qr=v((lc,Ur)=>{var ko=G("util"),Br=Gr(),Fr=["message","name","stack"],No=new Set(Fr.concat(["__safety","_stack","plugin","showProperties","showStack","domain","domainEmitter","domainThrown"])),Ho=["fileName","lineNumber","message","name","plugin","showProperties","showStack","stack"];function ne(e,t,r){if(!(this instanceof ne))return new ne(e,t,r);Error.call(this);var n=Go(e,t,r),s=this;if(typeof n.error=="object"){var o=new Set(Object.keys(n.error).concat(Fr));o.forEach(function(l){s[l]=n.error[l]})}if(Ho.forEach(function(l){l in n&&(this[l]=n[l])},this),!this.stack){var i={};i.toString=function(){return this._messageWithDetails()+`
Stack:`}.bind(this),Error.captureStackTrace(i,arguments.callee||this.constructor),this.__safety=i}if(!this.plugin)throw new Error("Missing plugin name");if(!this.message)throw new Error("Missing error message")}ko.inherits(ne,Error);ne.prototype._messageWithDetails=function(){var e=`Message:
    `+this.message,t=this._messageDetails();return t!==""&&(e+=`
`+t),e};ne.prototype._messageDetails=function(){if(!this.showProperties)return"";var e=Object.keys(this).filter(function(o){return!No.has(o)}),t=e.length;if(t===0)return"";for(var r="",n=0;t--;){var s=e[n++];r+="    ",r+=s+": "+this[s],r+=`
`}return`Details:
`+r};ne.prototype.toString=function(){var e=function(r){return this._messageWithDetails()+`
Stack:
`+r}.bind(this),t="";return this.showStack?(this.__safety?t=this.__safety.stack:this._stack?t=e(this._stack):t=e(this.stack),Dr(t,this)):(t=this._messageWithDetails(),Dr(t,this))};function Dr(e,t){var r=Br.red(t.name);return r+=" in plugin ",r+='"'+Br.cyan(t.plugin)+'"',r+=`
`,r+=e,r}function Go(e,t,r){return typeof e=="object"?Mr(e):(t instanceof Error?r=Object.assign({},r,{error:t}):typeof t=="object"?r=Object.assign({},t):r=Object.assign({},r,{message:t}),r.plugin=e,Mr(r))}function Mr(e){return Object.assign({showStack:!1,showProperties:!0},e)}Ur.exports=ne});var zr=v((fc,Xr)=>{Xr.exports=Kr;Kr.sync=Do;var jr=G("fs");function Bo(e,t){var r=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&e.substr(-s.length).toLowerCase()===s)return!0}return!1}function Wr(e,t,r){return!e.isSymbolicLink()&&!e.isFile()?!1:Bo(t,r)}function Kr(e,t,r){jr.stat(e,function(n,s){r(n,n?!1:Wr(s,e,t))})}function Do(e,t){return Wr(jr.statSync(e),e,t)}});var Jr=v((pc,Zr)=>{Zr.exports=Yr;Yr.sync=Mo;var Vr=G("fs");function Yr(e,t,r){Vr.stat(e,function(n,s){r(n,n?!1:Qr(s,t))})}function Mo(e,t){return Qr(Vr.statSync(e),t)}function Qr(e,t){return e.isFile()&&Fo(e,t)}function Fo(e,t){var r=e.mode,n=e.uid,s=e.gid,o=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),i=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),l=parseInt("100",8),p=parseInt("010",8),h=parseInt("001",8),m=l|p,x=r&h||r&p&&s===i||r&l&&n===o||r&m&&o===0;return x}});var tn=v((mc,en)=>{var dc=G("fs"),Ue;process.platform==="win32"||global.TESTING_WINDOWS?Ue=zr():Ue=Jr();en.exports=yt;yt.sync=Uo;function yt(e,t,r){if(typeof t=="function"&&(r=t,t={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){yt(e,t||{},function(o,i){o?s(o):n(i)})})}Ue(e,t||{},function(n,s){n&&(n.code==="EACCES"||t&&t.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function Uo(e,t){try{return Ue.sync(e,t||{})}catch(r){if(t&&t.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var un=v((hc,cn)=>{var le=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",rn=G("path"),qo=le?";":":",nn=tn(),sn=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),on=(e,t)=>{let r=t.colon||qo,n=e.match(/\//)||le&&e.match(/\\/)?[""]:[...le?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],s=le?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=le?s.split(r):[""];return le&&e.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},an=(e,t,r)=>{typeof t=="function"&&(r=t,t={}),t||(t={});let{pathEnv:n,pathExt:s,pathExtExe:o}=on(e,t),i=[],l=h=>new Promise((m,x)=>{if(h===n.length)return t.all&&i.length?m(i):x(sn(e));let E=n[h],R=/^".*"$/.test(E)?E.slice(1,-1):E,y=rn.join(R,e),w=!R&&/^\.[\\\/]/.test(e)?e.slice(0,2)+y:y;m(p(w,h,0))}),p=(h,m,x)=>new Promise((E,R)=>{if(x===s.length)return E(l(m+1));let y=s[x];nn(h+y,{pathExt:o},(w,F)=>{if(!w&&F)if(t.all)i.push(h+y);else return E(h+y);return E(p(h,m,x+1))})});return r?l(0).then(h=>r(null,h),r):l(0)},jo=(e,t)=>{t=t||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=on(e,t),o=[];for(let i=0;i<r.length;i++){let l=r[i],p=/^".*"$/.test(l)?l.slice(1,-1):l,h=rn.join(p,e),m=!p&&/^\.[\\\/]/.test(e)?e.slice(0,2)+h:h;for(let x=0;x<n.length;x++){let E=m+n[x];try{if(nn.sync(E,{pathExt:s}))if(t.all)o.push(E);else return E}catch{}}}if(t.all&&o.length)return o;if(t.nothrow)return null;throw sn(e)};cn.exports=an;an.sync=jo});var fn=v((gc,bt)=>{"use strict";var ln=(e={})=>{let t=e.env||process.env;return(e.platform||process.platform)!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};bt.exports=ln;bt.exports.default=ln});var hn=v((yc,mn)=>{"use strict";var pn=G("path"),Wo=un(),Ko=fn();function dn(e,t){let r=e.options.env||process.env,n=process.cwd(),s=e.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(e.options.cwd)}catch{}let i;try{i=Wo.sync(e.command,{path:r[Ko({env:r})],pathExt:t?pn.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=pn.resolve(s?e.options.cwd:"",i)),i}function Xo(e){return dn(e)||dn(e,!0)}mn.exports=Xo});var gn=v((bc,Et)=>{"use strict";var xt=/([()\][%!^"`<>&|;, *?])/g;function zo(e){return e=e.replace(xt,"^$1"),e}function Vo(e,t){return e=`${e}`,e=e.replace(/(\\*)"/g,'$1$1\\"'),e=e.replace(/(\\*)$/,"$1$1"),e=`"${e}"`,e=e.replace(xt,"^$1"),t&&(e=e.replace(xt,"^$1")),e}Et.exports.command=zo;Et.exports.argument=Vo});var bn=v((xc,yn)=>{"use strict";yn.exports=/^#!(.*)/});var En=v((Ec,xn)=>{"use strict";var Yo=bn();xn.exports=(e="")=>{let t=e.match(Yo);if(!t)return null;let[r,n]=t[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var wn=v((Sc,Sn)=>{"use strict";var St=G("fs"),Qo=En();function Zo(e){let r=Buffer.alloc(150),n;try{n=St.openSync(e,"r"),St.readSync(n,r,0,150,0),St.closeSync(n)}catch{}return Qo(r.toString())}Sn.exports=Zo});var Cn=v((wc,_n)=>{"use strict";var Jo=G("path"),An=hn(),Rn=gn(),ei=wn(),ti=process.platform==="win32",ri=/\.(?:com|exe)$/i,ni=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function si(e){e.file=An(e);let t=e.file&&ei(e.file);return t?(e.args.unshift(e.file),e.command=t,An(e)):e.file}function oi(e){if(!ti)return e;let t=si(e),r=!ri.test(t);if(e.options.forceShell||r){let n=ni.test(t);e.command=Jo.normalize(e.command),e.command=Rn.command(e.command),e.args=e.args.map(o=>Rn.argument(o,n));let s=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${s}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}function ii(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null),t=t?t.slice(0):[],r=Object.assign({},r);let n={command:e,args:t,options:r,file:void 0,original:{command:e,args:t}};return r.shell?n:oi(n)}_n.exports=ii});var Pn=v((Ac,vn)=>{"use strict";var wt=process.platform==="win32";function At(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function ai(e,t){if(!wt)return;let r=e.emit;e.emit=function(n,s){if(n==="exit"){let o=Tn(s,t,"spawn");if(o)return r.call(e,"error",o)}return r.apply(e,arguments)}}function Tn(e,t){return wt&&e===1&&!t.file?At(t.original,"spawn"):null}function ci(e,t){return wt&&e===1&&!t.file?At(t.original,"spawnSync"):null}vn.exports={hookChildProcess:ai,verifyENOENT:Tn,verifyENOENTSync:ci,notFoundError:At}});var In=v((Rc,fe)=>{"use strict";var $n=G("child_process"),Rt=Cn(),_t=Pn();function On(e,t,r){let n=Rt(e,t,r),s=$n.spawn(n.command,n.args,n.options);return _t.hookChildProcess(s,n),s}function ui(e,t,r){let n=Rt(e,t,r),s=$n.spawnSync(n.command,n.args,n.options);return s.error=s.error||_t.verifyENOENTSync(s.status,n),s}fe.exports=On;fe.exports.spawn=On;fe.exports.sync=ui;fe.exports._parse=Rt;fe.exports._enoent=_t});var is=v((vu,os)=>{"use strict";var{PassThrough:oa}=G("stream");os.exports=function(){var e=[],t=new oa({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=n,t.on("unpipe",s),Array.prototype.slice.call(arguments).forEach(r),t;function r(o){return Array.isArray(o)?(o.forEach(r),this):(e.push(o),o.once("end",s.bind(null,o)),o.once("error",t.emit.bind(t,"error")),o.pipe(t,{end:!1}),this)}function n(){return e.length==0}function s(o){e=e.filter(function(i){return i!==o}),!e.length&&t.readable&&t.end()}}});var Cs=de(_r(),1);import Te from"node:console";import{access as Ua,mkdir as qa,writeFile as ja}from"node:fs/promises";import{dirname as Wa,join as Ka,resolve as Rs}from"node:path";import _s from"node:process";import{parseArgs as Xa}from"node:util";var Cr={bugs:"https://github.com/cedx/php-minifier/issues",description:"Minify PHP source code by removing comments and whitespace.",homepage:"https://github.com/cedx/php-minifier",license:"MIT",name:"@cedx/php-minifier",repository:"cedx/php-minifier",type:"module",version:"2.0.0",author:{email:"cedric@belin.io",name:"C\xE9dric Belin",url:"https://belin.io"},bin:{php_minifier:"./bin/php_minifier.js"},dependencies:{execa:"^8.0.1","fancy-log":"^2.0.0","get-port":"^7.0.0","plugin-error":"^2.0.1",readdirp:"^3.6.0"},devDependencies:{"@types/fancy-log":"^2.0.2","@types/gulp":"^4.0.17","@types/node":"=20.11.5","@types/vinyl":"^2.0.11","@typescript-eslint/eslint-plugin":"^6.19.1","@typescript-eslint/parser":"^6.19.1",esbuild:"^0.19.12",eslint:"^8.56.0",typedoc:"^0.25.7",typescript:"^5.3.3",vinyl:"^3.0.0"},engines:{node:">=20.0.0"},exports:{types:"./lib/index.d.ts",import:"./lib/index.js"},files:["lib/","src/","www/"],imports:{"#phpMinifier":{types:"./lib/index.d.ts",import:"./lib/index.js"}},keywords:["compress","gulp","gulpplugin","minify","php"],peerDependencies:{gulp:">=4.0.0"},scripts:{build:"tsc --project src/tsconfig.json && esbuild --allow-overwrite --bundle --format=esm --legal-comments=none --log-level=warning --minify --outfile=bin/php_minifier.js --platform=node src/cli/main.ts",clean:"node tool/clean.js",dist:"npm run clean && npm run build && node tool/dist.js && git update-index --chmod=+x bin/php_minifier.js",doc:"typedoc --options etc/typedoc.js && node tool/doc.js",lint:"tsc --project tsconfig.json && eslint --config=etc/eslint.cjs src test tool",postpublish:"node tool/publish.js",prepack:"npm run dist",start:"npm run build && node bin/php_minifier.js --help",test:"npm run build && node --test --test-reporter=spec"}};var Tr=`
Minify PHP source code by removing comments and whitespace.

Usage:
  php_minifier [options] <input> <output>

Arguments:
  input            The path to the input directory.
  output           The path to the output directory.

Options:
  -b, --binary     The path to the PHP executable.
  -e, --extension  The extension of the PHP files to process. Defaults to "php".
  -m, --mode       The operation mode of the minifier. Defaults to "safe".
  -s, --silent     Value indicating whether to silence the minifier output.
  -h, --help       Display this help.
  -v, --version    Output the version number.
`;var Ma=de(kr(),1),Fa=de(qr(),1);import{normalize as ka,resolve as Na}from"node:path";import{fileURLToPath as Ha}from"node:url";var xs=de(In(),1);import{Buffer as Aa}from"node:buffer";import Ra from"node:path";import Vt from"node:child_process";import rt from"node:process";function Ct(e){let t=typeof e=="string"?`
`:10,r=typeof e=="string"?"\r":13;return e[e.length-1]===t&&(e=e.slice(0,-1)),e[e.length-1]===r&&(e=e.slice(0,-1)),e}import je from"node:process";import xe from"node:path";import Ln from"node:url";function qe(e={}){let{env:t=process.env,platform:r=process.platform}=e;return r!=="win32"?"PATH":Object.keys(t).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function li(e={}){let{cwd:t=je.cwd(),path:r=je.env[qe()],execPath:n=je.execPath}=e,s,o=n instanceof URL?Ln.fileURLToPath(n):n,i=t instanceof URL?Ln.fileURLToPath(t):t,l=xe.resolve(i),p=[];for(;s!==l;)p.push(xe.join(l,"node_modules/.bin")),s=l,l=xe.resolve(l,"..");return p.push(xe.resolve(i,o,"..")),[...p,r].join(xe.delimiter)}function kn({env:e=je.env,...t}={}){e={...e};let r=qe({env:e});return t.path=e[r],e[r]=li(t),e}var fi=(e,t,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let s=Object.getOwnPropertyDescriptor(e,r),o=Object.getOwnPropertyDescriptor(t,r);!pi(s,o)&&n||Object.defineProperty(e,r,o)},pi=function(e,t){return e===void 0||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},di=(e,t)=>{let r=Object.getPrototypeOf(t);r!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,r)},mi=(e,t)=>`/* Wrapped ${e}*/
${t}`,hi=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),gi=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),yi=(e,t,r)=>{let n=r===""?"":`with ${r.trim()}() `,s=mi.bind(null,n,t.toString());Object.defineProperty(s,"name",gi),Object.defineProperty(e,"toString",{...hi,value:s})};function Tt(e,t,{ignoreNonConfigurable:r=!1}={}){let{name:n}=e;for(let s of Reflect.ownKeys(t))fi(e,t,s,r);return di(e,t),yi(e,t,n),e}var We=new WeakMap,Nn=(e,t={})=>{if(typeof e!="function")throw new TypeError("Expected a function");let r,n=0,s=e.displayName||e.name||"<anonymous>",o=function(...i){if(We.set(o,++n),n===1)r=e.apply(this,i),e=null;else if(t.throw===!0)throw new Error(`Function \`${s}\` can only be called once`);return r};return Tt(o,e),We.set(o,n),o};Nn.callCount=e=>{if(!We.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return We.get(e)};var Hn=Nn;import Ti from"node:process";import{constants as Si}from"node:os";var Gn=()=>{let e=Dn-Bn+1;return Array.from({length:e},bi)},bi=(e,t)=>({name:`SIGRT${t+1}`,number:Bn+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}),Bn=34,Dn=64;import{constants as xi}from"node:os";var Mn=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var vt=()=>{let e=Gn();return[...Mn,...e].map(Ei)},Ei=({name:e,number:t,description:r,action:n,forced:s=!1,standard:o})=>{let{signals:{[e]:i}}=xi,l=i!==void 0;return{name:e,number:l?i:t,description:r,supported:l,action:n,forced:s,standard:o}};var wi=()=>{let e=vt();return Object.fromEntries(e.map(Ai))},Ai=({name:e,number:t,description:r,supported:n,action:s,forced:o,standard:i})=>[e,{name:e,number:t,description:r,supported:n,action:s,forced:o,standard:i}],Fn=wi(),Ri=()=>{let e=vt(),t=65,r=Array.from({length:t},(n,s)=>_i(s,e));return Object.assign({},...r)},_i=(e,t)=>{let r=Ci(e,t);if(r===void 0)return{};let{name:n,description:s,supported:o,action:i,forced:l,standard:p}=r;return{[e]:{name:n,number:e,description:s,supported:o,action:i,forced:l,standard:p}}},Ci=(e,t)=>{let r=t.find(({name:n})=>Si.signals[n]===e);return r!==void 0?r:t.find(n=>n.number===e)},qc=Ri();var vi=({timedOut:e,timeout:t,errorCode:r,signal:n,signalDescription:s,exitCode:o,isCanceled:i})=>e?`timed out after ${t} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${s})`:o!==void 0?`failed with exit code ${o}`:"failed",Ee=({stdout:e,stderr:t,all:r,error:n,signal:s,exitCode:o,command:i,escapedCommand:l,timedOut:p,isCanceled:h,killed:m,parsed:{options:{timeout:x,cwd:E=Ti.cwd()}}})=>{o=o===null?void 0:o,s=s===null?void 0:s;let R=s===void 0?void 0:Fn[s].description,y=n&&n.code,F=`Command ${vi({timedOut:p,timeout:x,errorCode:y,signal:s,signalDescription:R,exitCode:o,isCanceled:h})}: ${i}`,U=Object.prototype.toString.call(n)==="[object Error]",M=U?`${F}
${n.message}`:F,C=[M,t,e].filter(Boolean).join(`
`);return U?(n.originalMessage=n.message,n.message=C):n=new Error(C),n.shortMessage=M,n.command=i,n.escapedCommand=l,n.exitCode=o,n.signal=s,n.signalDescription=R,n.stdout=e,n.stderr=t,n.cwd=E,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!p,n.isCanceled=h,n.killed=m&&!p,n};var Ke=["stdin","stdout","stderr"],Pi=e=>Ke.some(t=>e[t]!==void 0),Un=e=>{if(!e)return;let{stdio:t}=e;if(t===void 0)return Ke.map(n=>e[n]);if(Pi(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${Ke.map(n=>`\`${n}\``).join(", ")}`);if(typeof t=="string")return t;if(!Array.isArray(t))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof t}\``);let r=Math.max(t.length,Ke.length);return Array.from({length:r},(n,s)=>t[s])};import Ii from"node:os";var se=[];se.push("SIGHUP","SIGINT","SIGTERM");process.platform!=="win32"&&se.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&se.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT");var Xe=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",Pt=Symbol.for("signal-exit emitter"),$t=globalThis,$i=Object.defineProperty.bind(Object),Ot=class{emitted={afterExit:!1,exit:!1};listeners={afterExit:[],exit:[]};count=0;id=Math.random();constructor(){if($t[Pt])return $t[Pt];$i($t,Pt,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,r){this.listeners[t].push(r)}removeListener(t,r){let n=this.listeners[t],s=n.indexOf(r);s!==-1&&(s===0&&n.length===1?n.length=0:n.splice(s,1))}emit(t,r,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let s=!1;for(let o of this.listeners[t])s=o(r,n)===!0||s;return t==="exit"&&(s=this.emit("afterExit",r,n)||s),s}},ze=class{},Oi=e=>({onExit(t,r){return e.onExit(t,r)},load(){return e.load()},unload(){return e.unload()}}),It=class extends ze{onExit(){return()=>{}}load(){}unload(){}},Lt=class extends ze{#n=kt.platform==="win32"?"SIGINT":"SIGHUP";#t=new Ot;#e;#r;#i;#o={};#s=!1;constructor(t){super(),this.#e=t,this.#o={};for(let r of se)this.#o[r]=()=>{let n=this.#e.listeners(r),{count:s}=this.#t,o=t;if(typeof o.__signal_exit_emitter__=="object"&&typeof o.__signal_exit_emitter__.count=="number"&&(s+=o.__signal_exit_emitter__.count),n.length===s){this.unload();let i=this.#t.emit("exit",null,r),l=r==="SIGHUP"?this.#n:r;i||t.kill(t.pid,l)}};this.#i=t.reallyExit,this.#r=t.emit}onExit(t,r){if(!Xe(this.#e))return()=>{};this.#s===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#s){this.#s=!0,this.#t.count+=1;for(let t of se)try{let r=this.#o[t];r&&this.#e.on(t,r)}catch{}this.#e.emit=(t,...r)=>this.#c(t,...r),this.#e.reallyExit=t=>this.#a(t)}}unload(){this.#s&&(this.#s=!1,se.forEach(t=>{let r=this.#o[t];if(!r)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,r)}catch{}}),this.#e.emit=this.#r,this.#e.reallyExit=this.#i,this.#t.count-=1)}#a(t){return Xe(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#c(t,...r){let n=this.#r;if(t==="exit"&&Xe(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let s=n.call(this.#e,t,...r);return this.#t.emit("exit",this.#e.exitCode,null),s}else return n.call(this.#e,t,...r)}},kt=globalThis.process,{onExit:qn,load:Qc,unload:Zc}=Oi(Xe(kt)?new Lt(kt):new It);var Li=1e3*5,jn=(e,t="SIGTERM",r={})=>{let n=e(t);return ki(e,t,r,n),n},ki=(e,t,r,n)=>{if(!Ni(t,r,n))return;let s=Gi(r),o=setTimeout(()=>{e("SIGKILL")},s);o.unref&&o.unref()},Ni=(e,{forceKillAfterTimeout:t},r)=>Hi(e)&&t!==!1&&r,Hi=e=>e===Ii.constants.signals.SIGTERM||typeof e=="string"&&e.toUpperCase()==="SIGTERM",Gi=({forceKillAfterTimeout:e=!0})=>{if(e===!0)return Li;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e},Wn=(e,t)=>{e.kill()&&(t.isCanceled=!0)},Bi=(e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))},Kn=(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(t===0||t===void 0)return n;let s,o=new Promise((l,p)=>{s=setTimeout(()=>{Bi(e,r,p)},t)}),i=n.finally(()=>{clearTimeout(s)});return Promise.race([o,i])},Xn=({timeout:e})=>{if(e!==void 0&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},zn=async(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;let s=qn(()=>{e.kill()});return n.finally(()=>{s()})};import{createWriteStream as Di}from"node:fs";import{ChildProcess as Mi}from"node:child_process";function Ve(e){return e!==null&&typeof e=="object"&&typeof e.pipe=="function"}function Nt(e){return Ve(e)&&e.writable!==!1&&typeof e._write=="function"&&typeof e._writableState=="object"}var Fi=e=>e instanceof Mi&&typeof e.then=="function",Ht=(e,t,r)=>{if(typeof r=="string")return e[t].pipe(Di(r)),e;if(Nt(r))return e[t].pipe(r),e;if(!Fi(r))throw new TypeError("The second argument must be a string, a stream or an Execa child process.");if(!Nt(r.stdin))throw new TypeError("The target child process's stdin must be available.");return e[t].pipe(r.stdin),r},Vn=e=>{e.stdout!==null&&(e.pipeStdout=Ht.bind(void 0,e,"stdout")),e.stderr!==null&&(e.pipeStderr=Ht.bind(void 0,e,"stderr")),e.all!==void 0&&(e.pipeAll=Ht.bind(void 0,e,"all"))};import{createReadStream as ia,readFileSync as aa}from"node:fs";import{setTimeout as ca}from"node:timers/promises";var Se=async(e,{init:t,convertChunk:r,getSize:n,truncateChunk:s,addChunk:o,getFinalChunk:i,finalize:l},{maxBuffer:p=Number.POSITIVE_INFINITY}={})=>{if(!qi(e))throw new Error("The first argument must be a Readable, a ReadableStream, or an async iterable.");let h=t();h.length=0;try{for await(let m of e){let x=ji(m),E=r[x](m,h);Zn({convertedChunk:E,state:h,getSize:n,truncateChunk:s,addChunk:o,maxBuffer:p})}return Ui({state:h,convertChunk:r,getSize:n,truncateChunk:s,addChunk:o,getFinalChunk:i,maxBuffer:p}),l(h)}catch(m){throw m.bufferedData=l(h),m}},Ui=({state:e,getSize:t,truncateChunk:r,addChunk:n,getFinalChunk:s,maxBuffer:o})=>{let i=s(e);i!==void 0&&Zn({convertedChunk:i,state:e,getSize:t,truncateChunk:r,addChunk:n,maxBuffer:o})},Zn=({convertedChunk:e,state:t,getSize:r,truncateChunk:n,addChunk:s,maxBuffer:o})=>{let i=r(e),l=t.length+i;if(l<=o){Yn(e,t,s,l);return}let p=n(e,o-t.length);throw p!==void 0&&Yn(p,t,s,o),new Ye},Yn=(e,t,r,n)=>{t.contents=r(e,t,n),t.length=n},qi=e=>typeof e=="object"&&e!==null&&typeof e[Symbol.asyncIterator]=="function",ji=e=>{let t=typeof e;if(t==="string")return"string";if(t!=="object"||e===null)return"others";if(globalThis.Buffer?.isBuffer(e))return"buffer";let r=Qn.call(e);return r==="[object ArrayBuffer]"?"arrayBuffer":r==="[object DataView]"?"dataView":Number.isInteger(e.byteLength)&&Number.isInteger(e.byteOffset)&&Qn.call(e.buffer)==="[object ArrayBuffer]"?"typedArray":"others"},{toString:Qn}=Object.prototype,Ye=class extends Error{name="MaxBufferError";constructor(){super("maxBuffer exceeded")}};var Gt=e=>e,Bt=()=>{},Dt=({contents:e})=>e,Qe=e=>{throw new Error(`Streams in object mode are not supported: ${String(e)}`)},Ze=e=>e.length;async function Mt(e,t){return Se(e,Ji,t)}var Wi=()=>({contents:new ArrayBuffer(0)}),Ki=e=>Xi.encode(e),Xi=new TextEncoder,Jn=e=>new Uint8Array(e),es=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength),zi=(e,t)=>e.slice(0,t),Vi=(e,{contents:t,length:r},n)=>{let s=ns()?Qi(t,n):Yi(t,n);return new Uint8Array(s).set(e,r),s},Yi=(e,t)=>{if(t<=e.byteLength)return e;let r=new ArrayBuffer(rs(t));return new Uint8Array(r).set(new Uint8Array(e),0),r},Qi=(e,t)=>{if(t<=e.maxByteLength)return e.resize(t),e;let r=new ArrayBuffer(t,{maxByteLength:rs(t)});return new Uint8Array(r).set(new Uint8Array(e),0),r},rs=e=>ts**Math.ceil(Math.log(e)/Math.log(ts)),ts=2,Zi=({contents:e,length:t})=>ns()?e:e.slice(0,t),ns=()=>"resize"in ArrayBuffer.prototype,Ji={init:Wi,convertChunk:{string:Ki,buffer:Jn,arrayBuffer:Jn,dataView:es,typedArray:es,others:Qe},getSize:Ze,truncateChunk:zi,addChunk:Vi,getFinalChunk:Bt,finalize:Zi};async function Je(e,t){if(!("Buffer"in globalThis))throw new Error("getStreamAsBuffer() is only supported in Node.js");try{return ss(await Mt(e,t))}catch(r){throw r.bufferedData!==void 0&&(r.bufferedData=ss(r.bufferedData)),r}}var ss=e=>globalThis.Buffer.from(e);async function Ft(e,t){return Se(e,sa,t)}var ea=()=>({contents:"",textDecoder:new TextDecoder}),et=(e,{textDecoder:t})=>t.decode(e,{stream:!0}),ta=(e,{contents:t})=>t+e,ra=(e,t)=>e.slice(0,t),na=({textDecoder:e})=>{let t=e.decode();return t===""?void 0:t},sa={init:ea,convertChunk:{string:Gt,buffer:et,arrayBuffer:et,dataView:et,typedArray:et,others:Qe},getSize:Ze,truncateChunk:ra,addChunk:ta,getFinalChunk:na,finalize:Dt};var as=de(is(),1),cs=e=>{if(e!==void 0)throw new TypeError("The `input` and `inputFile` options cannot be both set.")},ua=({input:e,inputFile:t})=>typeof t!="string"?e:(cs(e),aa(t)),us=e=>{let t=ua(e);if(Ve(t))throw new TypeError("The `input` option cannot be a stream in sync mode");return t},la=({input:e,inputFile:t})=>typeof t!="string"?e:(cs(e),ia(t)),ls=(e,t)=>{let r=la(t);r!==void 0&&(Ve(r)?r.pipe(e.stdin):e.stdin.end(r))},fs=(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;let r=(0,as.default)();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},Ut=async(e,t)=>{if(!(!e||t===void 0)){await ca(0),e.destroy();try{return await t}catch(r){return r.bufferedData}}},qt=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(!(!e||!r))return t==="utf8"||t==="utf-8"?Ft(e,{maxBuffer:n}):t===null||t==="buffer"?Je(e,{maxBuffer:n}):fa(e,n,t)},fa=async(e,t,r)=>(await Je(e,{maxBuffer:t})).toString(r),ps=async({stdout:e,stderr:t,all:r},{encoding:n,buffer:s,maxBuffer:o},i)=>{let l=qt(e,{encoding:n,buffer:s,maxBuffer:o}),p=qt(t,{encoding:n,buffer:s,maxBuffer:o}),h=qt(r,{encoding:n,buffer:s,maxBuffer:o*2});try{return await Promise.all([i,l,p,h])}catch(m){return Promise.all([{error:m,signal:m.signal,timedOut:m.timedOut},Ut(e,l),Ut(t,p),Ut(r,h)])}};var pa=(async()=>{})().constructor.prototype,da=["then","catch","finally"].map(e=>[e,Reflect.getOwnPropertyDescriptor(pa,e)]),jt=(e,t)=>{for(let[r,n]of da){let s=typeof t=="function"?(...o)=>Reflect.apply(n.value,t(),o):n.value.bind(t);Reflect.defineProperty(e,r,{...n,value:s})}},ds=e=>new Promise((t,r)=>{e.on("exit",(n,s)=>{t({exitCode:n,signal:s})}),e.on("error",n=>{r(n)}),e.stdin&&e.stdin.on("error",n=>{r(n)})});import{Buffer as ma}from"node:buffer";import{ChildProcess as ha}from"node:child_process";var gs=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],ga=/^[\w.-]+$/,ya=e=>typeof e!="string"||ga.test(e)?e:`"${e.replaceAll('"','\\"')}"`,Wt=(e,t)=>gs(e,t).join(" "),Kt=(e,t)=>gs(e,t).map(r=>ya(r)).join(" "),ba=/ +/g;var ms=e=>{let t=typeof e;if(t==="string")return e;if(t==="number")return String(e);if(t==="object"&&e!==null&&!(e instanceof ha)&&"stdout"in e){let r=typeof e.stdout;if(r==="string")return e.stdout;if(ma.isBuffer(e.stdout))return e.stdout.toString();throw new TypeError(`Unexpected "${r}" stdout in template expression`)}throw new TypeError(`Unexpected "${t}" in template expression`)},hs=(e,t,r)=>r||e.length===0||t.length===0?[...e,...t]:[...e.slice(0,-1),`${e.at(-1)}${t[0]}`,...t.slice(1)],xa=({templates:e,expressions:t,tokens:r,index:n,template:s})=>{let o=s??e.raw[n],i=o.split(ba).filter(Boolean),l=hs(r,i,o.startsWith(" "));if(n===t.length)return l;let p=t[n],h=Array.isArray(p)?p.map(m=>ms(m)):[ms(p)];return hs(l,h,o.endsWith(" "))},Xt=(e,t)=>{let r=[];for(let[n,s]of e.entries())r=xa({templates:e,expressions:t,tokens:r,index:n,template:s});return r};import{debuglog as Ea}from"node:util";import Sa from"node:process";var ys=Ea("execa").enabled,tt=(e,t)=>String(e).padStart(t,"0"),wa=()=>{let e=new Date;return`${tt(e.getHours(),2)}:${tt(e.getMinutes(),2)}:${tt(e.getSeconds(),2)}.${tt(e.getMilliseconds(),3)}`},zt=(e,{verbose:t})=>{t&&Sa.stderr.write(`[${wa()}] ${e}
`)};var _a=1e3*1e3*100,Ca=({env:e,extendEnv:t,preferLocal:r,localDir:n,execPath:s})=>{let o=t?{...rt.env,...e}:e;return r?kn({env:o,cwd:n,execPath:s}):o},Es=(e,t,r={})=>{let n=xs.default._parse(e,t,r);return e=n.command,t=n.args,r=n.options,r={maxBuffer:_a,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||rt.cwd(),execPath:rt.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,verbose:ys,...r},r.env=Ca(r),r.stdio=Un(r),rt.platform==="win32"&&Ra.basename(e,".exe")==="cmd"&&t.unshift("/q"),{file:e,args:t,options:r,parsed:n}},we=(e,t,r)=>typeof t!="string"&&!Aa.isBuffer(t)?r===void 0?void 0:"":e.stripFinalNewline?Ct(t):t;function Ae(e,t,r){let n=Es(e,t,r),s=Wt(e,t),o=Kt(e,t);zt(o,n.options),Xn(n.options);let i;try{i=Vt.spawn(n.file,n.args,n.options)}catch(R){let y=new Vt.ChildProcess,w=Promise.reject(Ee({error:R,stdout:"",stderr:"",all:"",command:s,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return jt(y,w),y}let l=ds(i),p=Kn(i,n.options,l),h=zn(i,n.options,p),m={isCanceled:!1};i.kill=jn.bind(null,i.kill.bind(i)),i.cancel=Wn.bind(null,i,m);let E=Hn(async()=>{let[{error:R,exitCode:y,signal:w,timedOut:F},U,M,C]=await ps(i,n.options,h),K=we(n.options,U),N=we(n.options,M),V=we(n.options,C);if(R||y!==0||w!==null){let B=Ee({error:R,exitCode:y,signal:w,stdout:K,stderr:N,all:V,command:s,escapedCommand:o,parsed:n,timedOut:F,isCanceled:m.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return B;throw B}return{command:s,escapedCommand:o,exitCode:0,stdout:K,stderr:N,all:V,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return ls(i,n.options),i.all=fs(i,n.options),Vn(i),jt(i,E),i}function Ta(e,t,r){let n=Es(e,t,r),s=Wt(e,t),o=Kt(e,t);zt(o,n.options);let i=us(n.options),l;try{l=Vt.spawnSync(n.file,n.args,{...n.options,input:i})}catch(m){throw Ee({error:m,stdout:"",stderr:"",all:"",command:s,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}let p=we(n.options,l.stdout,l.error),h=we(n.options,l.stderr,l.error);if(l.error||l.status!==0||l.signal!==null){let m=Ee({stdout:p,stderr:h,error:l.error,signal:l.signal,exitCode:l.status,command:s,escapedCommand:o,parsed:n,timedOut:l.error&&l.error.code==="ETIMEDOUT",isCanceled:!1,killed:l.signal!==null});if(!n.options.reject)return m;throw m}return{command:s,escapedCommand:o,exitCode:0,stdout:p,stderr:h,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}var va=({input:e,inputFile:t,stdio:r})=>e===void 0&&t===void 0&&r===void 0?{stdin:"inherit"}:{},bs=(e={})=>({preferLocal:!0,...va(e),...e});function Ss(e){function t(r,...n){if(!Array.isArray(r))return Ss({...e,...r});let[s,...o]=Xt(r,n);return Ae(s,o,bs(e))}return t.sync=(r,...n)=>{if(!Array.isArray(r))throw new TypeError("Please use $(options).sync`command` instead of $.sync(options)`command`.");let[s,...o]=Xt(r,n);return Ta(s,o,bs(e))},t}var sl=Ss();import Pa from"node:net";import $a from"node:os";var nt=class extends Error{constructor(t){super(`${t} is locked`)}},pe={old:new Set,young:new Set},Oa=1e3*15;var Re,Ia=()=>{let e=$a.networkInterfaces(),t=new Set([void 0,"0.0.0.0"]);for(let r of Object.values(e))for(let n of r)t.add(n.address);return t},ws=e=>new Promise((t,r)=>{let n=Pa.createServer();n.unref(),n.on("error",r),n.listen(e,()=>{let{port:s}=n.address();n.close(()=>{t(s)})})}),As=async(e,t)=>{if(e.host||e.port===0)return ws(e);for(let r of t)try{await ws({port:e.port,host:r})}catch(n){if(!["EADDRNOTAVAIL","EINVAL"].includes(n.code))throw n}return e.port},La=function*(e){e&&(yield*e),yield 0};async function Yt(e){let t,r=new Set;if(e&&(e.port&&(t=typeof e.port=="number"?[e.port]:e.port),e.exclude)){let s=e.exclude;if(typeof s[Symbol.iterator]!="function")throw new TypeError("The `exclude` option must be an iterable.");for(let o of s){if(typeof o!="number")throw new TypeError("Each item in the `exclude` option must be a number corresponding to the port you want excluded.");if(!Number.isSafeInteger(o))throw new TypeError(`Number ${o} in the exclude option is not a safe integer and can't be used`)}r=new Set(s)}Re===void 0&&(Re=setTimeout(()=>{Re=void 0,pe.old=pe.young,pe.young=new Set},Oa),Re.unref&&Re.unref());let n=Ia();for(let s of La(t))try{if(r.has(s))continue;let o=await As({...e,port:s},n);for(;pe.old.has(o)||pe.young.has(o);){if(s!==0)throw new nt(s);o=await As({...e,port:s},n)}return pe.young.add(o),o}catch(o){if(!["EADDRINUSE","EACCES"].includes(o.code)&&!(o instanceof nt))throw o}throw new Error("No available ports found")}var _e=class e{static#n="127.0.0.1";#t;#e=-1;#r=null;constructor(t="php"){this.#t=ka(t)}close(){return this.#r?.kill(),this.#r=null,Promise.resolve()}async listen(){return this.#r?this.#e:(this.#e=await Yt(),new Promise((t,r)=>{let n=["-S",`${e.#n}:${this.#e}`,"-t",Ha(new URL("../www",import.meta.url))];this.#r=Ae(this.#t,n),this.#r.on("error",r),setTimeout(()=>t(this.#e),1e3)}))}async transform(t){let r=await this.listen(),n=new URL(`http://${e.#n}:${r}/index.php`);n.searchParams.set("file",Na(t));let s=await fetch(n);if(!s.ok)throw new Error(`An error occurred while processing the script: ${t}`);return s.text()}};import{normalize as Ga,resolve as Ba}from"node:path";var Ce=class{#n;constructor(t="php"){this.#n=Ga(t)}close(){return Promise.resolve()}async transform(t){return(await Ae(this.#n,["-w",Ba(t)])).stdout}};async function za(){let{positionals:e,values:t}=Xa({allowPositionals:!0,options:{binary:{short:"b",type:"string",default:!1},extension:{short:"e",type:"string",default:!1},help:{short:"h",type:"boolean",default:!1},mode:{short:"m",type:"string",default:!1},silent:{short:"s",type:"boolean",default:!1},version:{short:"v",type:"boolean",default:!1}}});if(t.help||t.version)return Te.log(t.version?Cr.version:Tr.trim()),0;if(!e.length)return Te.error("You must provide the path to the input directory."),1;let r=Rs(e[0]);try{await Ua(r)}catch{return Te.error("The input directory was not found."),2}let n=e.length>1?Rs(e[1]):r;return await Va(r,n,t),0}async function Va(e,t,r={}){let n=r.binary??"php",s=r.extension??"php",o=r.mode??"safe",i=r.silent??!1,l=await Cs.default.promise(e,{fileFilter:`*.${s}`}),p=o=="fast"?new _e(n):new Ce(n),h=l.map(async m=>{i||Te.log(`Minifying: ${m.path}`);let x=await p.transform(m.fullPath),E=Ka(t,m.path);return await qa(Wa(E),{recursive:!0}),ja(E,x)});for(let m of h)await m;return p.close()}za().then(e=>_s.exitCode=e,e=>{Te.error(e instanceof Error?e.message:e),_s.exitCode=1});
